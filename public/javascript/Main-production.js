var CubeViz_ConfigurationLink=(function(){function b(){}b.save=function a(d,c,g,e,j,h){if(typeof h==="undefined"){h=false}var i=$.ajaxSetup();var f=$.support.cors;$.ajaxSetup({async:true,cache:false,type:"POST"});$.support.cors=true;$.ajax({url:d+"savecontenttofile/",data:{modelIri:c,stringifiedContent:JSON.stringify(g),type:e,useObservations:true===h?"true":"false"}}).error(function(m,k,l){$.ajaxSetup(i);$.support.cors=f;throw new Error("save error: "+m.responseText)}).done(function(k){$.ajaxSetup(i);$.support.cors=f;j(k)})};return b})();var CubeViz_Collection=(function(){function a(b){this.reset(b)}a.prototype.add=function(c,d,b){if(typeof b==="undefined"){b=false}if(false===b){if(true===_.isUndefined(c[this.idKey])){throw new Error("Key "+this.idKey+" in element not set!");return this}if(true===_.isUndefined(this.get(c[this.idKey]))){this._.push(c)}else{if((false===_.isUndefined(d)&&false===_.isUndefined(d.merge)&&d.merge==true)){this.remove(c[this.idKey]);this._.push(c)}}}else{this._.push(c)}return this};a.prototype.addList=function(c){var b=this;if(true==_.isArray(c)){_.each(c,function(d){b.add(d,null,true)})}else{if(true==_.isObject(c)){this.addList(_.values(c))}}return b};a.prototype.each=function(b){_.each(this._,b);return this};a.prototype.exists=function(b){return false===_.isUndefined(this.get(b))};a.prototype.get=function(d){var b=this;var c=_.filter(this._,function(e){if(e[b.idKey]==d){return true}else{return false}});return 1==c.length?c[0]:undefined};a.prototype.getFirst=function(){return _.first(this._)};a.prototype.getElementsValues=function(c){var b=new a();this.each(function(d){if(false===_.isUndefined(d[c])&&false===_.isNull(d[c])){b.add(d[c],null,true)}});return b};a.prototype.remove=function(c){var b=this;this._=_.reject(this._,function(d){return d[b.idKey]==c});return this};a.prototype.reset=function(b){this.idKey=undefined===b?(undefined===this.idKey?"id":this.idKey):b;this._=[];return this};a.prototype.size=function(){return _.size(this._)};a.prototype.sortAscendingBy=function(g){var f="";var e="";var j="";var i="";var h=false===_.isUndefined(g)?g:this.idKey;this._.sort(function(d,c){try{try{j=parseFloat(d[h]);i=parseFloat(c[h]);if(true===_.isNaN(j)||true===_.isNaN(i)){throw new Error()}}catch(k){j=d[h].toUpperCase();i=c[h].toUpperCase()}return(j<i)?-1:(j>i)?1:0}catch(l){}});return this};a.prototype.toObject=function(){var b=0;var c={};_.each(this._,function(d){c[b++]=d});return c};return a})();var CubeViz_Visualization=(function(){function CubeViz_Visualization(){this.name="CubeViz_Visualization";this.supportedClassNames=[]}CubeViz_Visualization.prototype.getName=function(){return this.name};CubeViz_Visualization.prototype.getSupportedClassNames=function(){return this.supportedClassNames};CubeViz_Visualization.prototype.isResponsibleFor=function(className){return _.contains(this.getSupportedClassNames(),className)};CubeViz_Visualization.prototype.load=function(c){if(true===this.isResponsibleFor(c)){var chart=null;eval("chart = new "+c+"();");return chart}else{throw new Error("Invalid c ("+c+") given!")}};CubeViz_Visualization.prototype.render=function(chart){return null};return CubeViz_Visualization})();var CubeViz_View_Abstract=(function(){function a(d,b,c){this.app=c;this.attachedTo=b;this.autostart=false;this.collection=new CubeViz_Collection();this.id=d||"view"}a.prototype.bindGlobalEvents=function(b){this.app.bindGlobalEvents(b,this);return this};a.prototype.bindUserInterfaceEvents=function(e){if(true===_.isUndefined(e)||0==_.size(e)){return}var d="";var b="";var c=this;_.each(e,function(g,f){if(false===_.isFunction(g)){g=c[g]}if(!g){throw new Error("Method "+g+" does not exist")}d=f.substr(0,f.indexOf(" "));b=f.substr(f.indexOf(" ")+1);$(b).on(d,$.proxy(g,c))})};a.prototype.destroy=function(){var b=$(this.attachedTo);b.off();if(true===b.is("div")){b.empty()}else{if(true===b.is("select")){b.find("option").remove()}}this.collection.reset();return this};a.prototype.initialize=function(){};a.prototype.triggerGlobalEvent=function(b,c){this.app.triggerEvent(b,c);return this};return a})();var CubeViz_View_Application=(function(){function CubeViz_View_Application(){this._viewInstances=new CubeViz_Collection();this._eventHandlers=new CubeViz_Collection();this._={}}CubeViz_View_Application.prototype.add=function(id,attachedTo,merge){var options=true===merge?{merge:true}:undefined;var viewObj={alreadyRendered:false,attachedTo:attachedTo,id:id,instance:null};eval("viewObj.instance = new "+id+'("'+attachedTo+'", this);');this._viewInstances.add(viewObj,options);return this};CubeViz_View_Application.prototype.bindGlobalEvents=function(events,callee){if(true===_.isUndefined(events)||0==_.size(events)){return this}var self=this;_.each(events,function(event){$(self).on(event.name,$.proxy(event.handler,callee))});return this};CubeViz_View_Application.prototype.destroyView=function(id){this._viewInstances.get(id).instance.destroy();return this};CubeViz_View_Application.prototype.get=function(id){return this._viewInstances.get(id)};CubeViz_View_Application.prototype.getDataCopy=function(){var backup=[this._.generatedVisualization];this._.generatedVisualization=undefined;var result=$.parseJSON(JSON.stringify(this._));this._.generatedVisualization=backup[1];return result};CubeViz_View_Application.prototype.remove=function(id){this._viewInstances.remove(id);return this};CubeViz_View_Application.prototype.renderAll=function(){var self=this;_.each(this._viewInstances._,function(view){self.renderView(view.id,view.attachedTo)});return this};CubeViz_View_Application.prototype.renderView=function(id,attachedTo){this.add(id,attachedTo).destroyView(id).get(id).instance.initialize();return this};CubeViz_View_Application.prototype.reset=function(){$(this).off();var self=this;_.each(this._viewInstances._,function(view){self.destroyView(view.id).add(view.id,view.attachedTo,true)});return this};CubeViz_View_Application.prototype.restoreDataCopy=function(copy){this._=$.parseJSON(JSON.stringify(copy));return this};CubeViz_View_Application.prototype.triggerEvent=function(eventName,data){$(this).trigger(eventName,[data]);return this};CubeViz_View_Application.prototype.unbindEvent=function(eventName){$(this).off(eventName);return this};return CubeViz_View_Application})();var CubeViz_View_Helper=(function(){function f(){}f.attachDialogTo=function k(p,o){var n={};var o=o||{};n.autoOpen=o.autoOpen||false;n.closeOnEscape=o.closeOnEscape||false;n.draggable=o.draggable||false;n.height=o.height||"auto";n.hide=o.hide||"slow";n.modal=o.modal||true;n.overlay=o.overlay||{"background-color":"#FFFFFF",opacity:0.5};n.resizable=o.resizable||false;n.show=o.show||"slow";n.width=o.width||"700";if(true===_.isUndefined(o.showCross)||false===o.showCross){n.open=function(q,r){$(".ui-dialog-titlebar-close",$(this).parent()).hide()}}p.dialog(n);p.data("hasDialog",true)};f.closeDialog=function e(n){n.dialog("close");n.data("isDialogOpen",false)};f.destroyDialog=function m(n){n.dialog("destroy");n.data("isDialogOpen",false)};f.hideCloseAndUpdateSpinner=function j(n){$(n.find(".cubeviz-dataSelectionModule-closeUpdateSpinner").first()).hide()};f.hideLeftSidebarSpinner=function c(){$("#cubeviz-dataSelectionModule-spinnerIcon").hide();$("#cubeviz-dataSelectionModule-spinnerText").hide();$("#cubeviz-dataSelectionModule-spinner").fadeOut("slow",function(){$("#cubeviz-dataSelectionModule-dataSelection").fadeIn("slow")})};f.openDialog=function d(n){n.dialog("open");n.data("isDialogOpen",true);$(".ui-widget-overlay").css("height",2*screen.height)};f.showCloseAndUpdateSpinner=function i(n){$(n.find(".cubeviz-dataSelectionModule-closeUpdateSpinner").first()).show()};f.showLeftSidebarSpinner=function b(){$("#cubeviz-dataSelectionModule-spinnerIcon").show();$("#cubeviz-dataSelectionModule-spinnerText").show();$("#cubeviz-dataSelectionModule-dataSelection").fadeOut("slow",function(){$("#cubeviz-dataSelectionModule-spinner").fadeIn("slow").show()})};f.sortLiItemsByAlphabet=function h(r){var o="";var n="";var q={};var p=[];r.sort(function(t,s){t=$(t).text().toUpperCase();s=$(s).text().toUpperCase();return(t<s)?-1:(t>s)?1:0});_.each(r,function(s){q=$(s).data("data");s=$(s).clone();$(s).data("data",q);p.push(s)});return p};f.sortLiItemsByCheckStatus=function l(q){var p={};var n=[];var o=[];_.each(q,function(r){if($($(r).children().first()).is(":checked")){p=$(r).data("data");r=$(r).clone();$(r).data("data",p);o.push(r)}else{n.push(r)}});_.each(n,function(r){p=$(r).data("data");r=$(r).clone();$(r).data("data",p);o.push(r)});return o};f.sortLiItemsByObservationCount=function a(s,u,t){var n="";var r=[];var p=[];var q=0;var o=[];_.each(s,function(v){n=$($(v).children().first()).val();q=0;_.each(t,function(w){if(n===w[u][0].value){++q}});$(v).data("observationCount",q);if(0<q){o.push($(v).clone())}else{p.push(v)}});o.sort(function(w,v){w=$(w).data("observationCount");v=$(v).data("observationCount");return(w<v)?1:(w>v)?-1:0});_.each(p,function(v){o.push($(v).clone())});return o};f.tplReplace=function g(n,p){if(true===_.isUndefined(p)){return n}var o=_.keys(p);_.each(o,function(q){n=n.replace("[["+q+"]]",_.str.trim(p[q]))});return _.str.trim(n)};return f})();var CubeViz_Visualization_Controller=(function(){function CubeViz_Visualization_Controller(){}CubeViz_Visualization_Controller.getColor=function getColor(variable){var color="#FFFFFF";if(true===_.isString(variable)||true===_.isNumber(variable)){color=""+CryptoJS.MD5(variable);color="#"+color.substr((color.length-6),6)}else{if(false===_.isUndefined(variable)){color=JSON.stringify(variable);color="#"+color.substr((color.length-6),6)}}return color};CubeViz_Visualization_Controller.getFromChartConfigByClass=function getFromChartConfigByClass(className,charts){var result=null;_.each(charts,function(chart){if(true===_.isNull(result)){if(className==chart.className){result=chart}}});return result};CubeViz_Visualization_Controller.getMultipleDimensions=function getMultipleDimensions(selectedComponentDimensions){var multipleDimensions=[];_.each(selectedComponentDimensions,function(selectedDimension){if(2<=_.keys(selectedDimension.__cv_elements).length){multipleDimensions.push(selectedDimension)}});return multipleDimensions};CubeViz_Visualization_Controller.getObjectValueByKeyString=function getObjectValueByKeyString(keyString,objToAccess){var call="objToAccess";var result=undefined;try{_.each(keyString.split("."),function(key){call+="."+key});eval("result = "+call)}catch(ex){}return result};CubeViz_Visualization_Controller.getOneElementDimensions=function getOneElementDimensions(selectedComponentDimensions){var oneElementDimensions=[];_.each(selectedComponentDimensions,function(selectedDimension){if(1==_.keys(selectedDimension.__cv_elements).length){oneElementDimensions.push(selectedDimension)}});return oneElementDimensions};CubeViz_Visualization_Controller.getVisualizationType=function getVisualizationType(className){var hC=new CubeViz_Visualization_HighCharts();var d3js=new CubeViz_Visualization_D3js();if(true===hC.isResponsibleFor(className)){return hC.getName()}else{if(true===d3js.isResponsibleFor(className)){return d3js.getName()}else{throw new Error("Unknown className "+className)}}};CubeViz_Visualization_Controller.linkify=function linkify(inputText){var emailAddressPattern=/\w+@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6})+/gim;var pseudoUrlPattern=/(^|[^\/])(www\.[\S]+(\b|$))/gim;var urlPattern=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;return inputText.replace(urlPattern,'<a href="$&" target="_blank">$&</a>').replace(pseudoUrlPattern,'$1<a href="http://$2" target="_blank">$2</a>').replace(emailAddressPattern,'<a href="mailto:$&">$&</a>')};CubeViz_Visualization_Controller.getDefaultChartConfig=function getDefaultChartConfig(chartConfig,numberOfMultipleDimensions){return{className:chartConfig[numberOfMultipleDimensions].charts[0].className,chartConfig:chartConfig[numberOfMultipleDimensions].charts[0]}};CubeViz_Visualization_Controller.setChartConfigClassEntry=function setChartConfigClassEntry(className,charts,newValue){for(var i in charts){if(className==charts[i].className){charts[i]=newValue}}};CubeViz_Visualization_Controller.updateVisualizationSettings=function updateVisualizationSettings(menuItemValues,visualizationSetting,chartConfigEntryDefaultConfig){var call="";var optionKey="";var optionVal="";var updatedSetting=visualizationSetting||{};if(0===_.keys(updatedSetting).length){updatedSetting=chartConfigEntryDefaultConfig}updatedSetting=$.parseJSON(JSON.stringify(updatedSetting));_.each(menuItemValues,function(menuItemValue){optionKey=$(menuItemValue).data("key");optionVal=$(menuItemValue).val();if(true===_.isUndefined(optionKey)){return}call="updatedSetting";_.each(optionKey.split("."),function(key){call+="."+key;eval(call+" = "+call+" || {};")});eval(call+" = optionVal;")});return updatedSetting};return CubeViz_Visualization_Controller})();var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var CubeViz_Visualization_D3js=(function(b){__extends(a,b);function a(){b.call(this);this.name="D3js";this.supportedClassNames=["CubeViz_Visualization_D3js_CirclePacking"]}a.prototype.render=function(c){c.getRenderResult()};return a})(CubeViz_Visualization);var CubeViz_Visualization_D3js_CirclePacking=(function(){function a(){this.chartConfig={};this.generatedData={name:"",children:[]}}a.prototype.computeData=function(h,g,b){var e=[];var f=[];var c=this;var d=null;_.each(h,function(i){f=[];e=[{name:"",size:""}];_.each(g,function(j){_.each(j.__cv_elements,function(k){if(k.__cv_uri===i[j["http://purl.org/linked-data/cube#dimension"]]){f.push(k.__cv_niceLabel)}})});e[0].name=f.join(" - ");if(false===_.isUndefined(i.__cv_temporaryNewValue)){d=i.__cv_temporaryNewValue}else{d=i[b["http://purl.org/linked-data/cube#measure"]]}e[0].size=DataCube_Observation.parseValue(d);c.generatedData.children.push({name:i.__cv_niceLabel,children:e})})};a.prototype.init=function(e,g,c,f,h,b,d){this.chartConfig=e;this.computeData(g,f,b);return this};a.prototype.getRenderResult=function(){var d=960;var c=d3.layout.pack().size([d-4,d-4]).value(function(f){return f.size});var b=d3.select("#cubeviz-index-visualization").append("svg").attr("width",d).attr("height",d).append("g").attr("transform","translate(2,2)");var e=b.datum(this.generatedData).selectAll(".node").data(c.nodes).enter().append("g").attr("class",function(f){return f.children?"node":"cubeviz-visualization-d3js-circleLeaf node"}).attr("transform",function(f){return"translate("+f.x+","+f.y+")"});e.append("title").text(function(f){return f.name+(f.children?"":": "+f.size)});e.append("circle").attr("r",function(f){return f.r});e.filter(function(f){return !f.children}).append("text").attr("dy",".3em").style("fill",this.chartConfig.style.circle.fill).style("font-size",this.chartConfig.style.circle["font-size"]).style("font-weight",this.chartConfig.style.circle["font-weight"]).style("text-anchor",this.chartConfig.style.circle["text-anchor"]).text(function(f){return f.name.substring(0,f.r*0.3)});return b};return a})();var CubeViz_Visualization_HighCharts=(function(b){__extends(a,b);function a(){b.call(this);this.name="HighCharts";this.supportedClassNames=["CubeViz_Visualization_HighCharts_Area","CubeViz_Visualization_HighCharts_AreaSpline","CubeViz_Visualization_HighCharts_Bar","CubeViz_Visualization_HighCharts_Column","CubeViz_Visualization_HighCharts_Line","CubeViz_Visualization_HighCharts_Pie","CubeViz_Visualization_HighCharts_Polar","CubeViz_Visualization_HighCharts_Spline"]}a.prototype.render=function(c){return new Highcharts.Chart(c.getRenderResult())};return a})(CubeViz_Visualization);var CubeViz_Visualization_HighCharts_Chart=(function(){function a(){}a.prototype.handleTwoDimensionsWithAtLeastOneDimensionElement=function(j,o,k,c,n,l){var q={};var h=0;var p=this;var r=l.getAxesElements(o);_.each(r,function(i){p.chartConfig.xAxis.categories.push(i.self.__cv_niceLabel);q[i.self.__cv_uri]=h++});var b=[];_.each(j,function(i){b.push(i["http://purl.org/linked-data/cube#dimension"])});var g={};var f=l.getAxesElements(k);var m="";var d={};var e=null;p.chartConfig.series=[];_.each(f,function(i){g={color:CubeViz_Visualization_Controller.getColor(i.self.__cv_uri),data:[],name:i.self.__cv_niceLabel,__cv_uri:i.self.__cv_uri};for(h=0;h<_.size(p.chartConfig.xAxis.categories);++h){g.data.push(null)}_.each(i.observations,function(s){if((false===_.isNull(c)&&(true===_.isNull(s[c])||true===_.isUndefined(s[c])))&&c!==s["http://purl.org/linked-data/cube#attribute"]){return}m="";_.each(b,function(t){m+=s[t]});if(true===_.isUndefined(d[m])){d[m]=true}else{return}if(false===_.isUndefined(s.__cv_temporaryNewValue)){e=s.__cv_temporaryNewValue}else{e=s[n]}if(false===_.isUndefined(s[n])){g.data[q[s[o]]]=parseFloat(e)}else{g.data[q[s[o]]]=null}});if(0==_.size(g.data)){}else{p.chartConfig.series.push(g)}})};a.prototype.handleOnlyOneElementDimension=function(e,b,i,g){var j=this;var f=null;var h=[];var d=g.getAxesElements(e);var c=null;this.chartConfig.xAxis.categories=["."];_.each(d,function(k){f=k.observations[_.keys(k.observations)[0]];if(false===_.isNull(b)&&(true===_.isNull(f[b])||true===_.isUndefined(f[b]))){return}if(false===_.isUndefined(f.__cv_temporaryNewValue)){c=f.__cv_temporaryNewValue}else{c=f[i]}j.chartConfig.series.push({name:k.self.__cv_niceLabel,data:[c]})})};a.prototype.handleOnlyOneMultipleDimension=function(h,b,g,e){var i=this;var d=null;var f=[];var j=e.sortAxis(h,"ascending").getAxesElements(h);var c=null;_.each(j,function(k){d=k.observations[_.keys(k.observations)[0]];if(false===_.isUndefined(d.__cv_temporaryNewValue)){c=d.__cv_temporaryNewValue}else{c=d[g]}c=DataCube_Observation.parseValue(c);if(false===c){return}if(false===_.isNull(b)&&(true===_.isNull(d[b])||true===_.isUndefined(d[b]))){return}i.chartConfig.xAxis.categories.push(k.self.__cv_niceLabel);f.push(c)});this.chartConfig.series=[{name:".",data:f}]};a.prototype.init=function(h,c,g,k,p,d,b){var m=0;var n=null;var j=null;var f=0;var l=new DataCube_Observation();var o=this;this.chartConfig=h;this.chartConfig.series=[];if(true===_.isUndefined(o.chartConfig.xAxis)){this.chartConfig.xAxis={categories:[]}}else{this.chartConfig.xAxis.categories=[]}this.chartConfig.title.text="";if(true===_.isUndefined(this.chartConfig.xAxis)){this.chartConfig.xAxis={title:{text:""}}}if(true===_.isUndefined(this.chartConfig.yAxis)){this.chartConfig.yAxis={title:{text:""}}}_.each(g,function(i){if(2>_.keys(i.__cv_elements).length){return}if(null==n){n=i["http://purl.org/linked-data/cube#dimension"]}else{j=i["http://purl.org/linked-data/cube#dimension"]}});if(null==j){_.each(g,function(i){if(1==_.keys(i.__cv_elements).length&&null==j){j=i["http://purl.org/linked-data/cube#dimension"]}})}this.chartConfig._cubeVizVisz=this.chartConfig._cubeVizVisz||{};if("true"==this.chartConfig._cubeVizVisz.doSwitchingAxes){var e=n;n=j;j=e}l.initialize(c,g,d["http://purl.org/linked-data/cube#measure"]);if(false===_.str.isBlank(n)&&false===_.str.isBlank(j)){this.handleTwoDimensionsWithAtLeastOneDimensionElement(g,n,j,b,d["http://purl.org/linked-data/cube#measure"],l)}else{if(false===_.str.isBlank(n)||false===_.str.isBlank(j)){if(false===_.str.isBlank(n)){this.handleOnlyOneMultipleDimension(n,b,d["http://purl.org/linked-data/cube#measure"],l)}else{this.handleOnlyOneElementDimension(j,b,d["http://purl.org/linked-data/cube#measure"],l)}}}this.setTooltip(g[Object.keys(g)[0]],d);return this};a.prototype.getRenderResult=function(){return this.chartConfig};a.prototype.setTooltip=function(d,b){var c=this;this.chartConfig.tooltip={formatter:function(){return d.__cv_niceLabel+": <b>"+this.x+"</b> <br/> "+b.__cv_niceLabel+": <b>"+_.str.numberFormat(this.y,4,",",".")+"</b>"}}};return a})();var CubeViz_Visualization_HighCharts_Area=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_AreaSpline=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Bar=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Column=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Line=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Pie=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.init=function(f,c,e,g,m,j){if(1<_.size(g)){throw new Error("Pie chart is only suitable for one dimension!");return}var k=g[_.keys(g)[0]]["http://purl.org/linked-data/cube#dimension"];var i="";var h=new DataCube_Observation();var l=this;var o=[];var d=null;this.chartConfig=f;this.chartConfig.colors=[];this.chartConfig.series=[];this.chartConfig.title.text="";if(true===_.isUndefined(this.chartConfig.xAxis)){this.chartConfig.xAxis={title:{text:""}}}if(true===_.isUndefined(this.chartConfig.yAxis)){this.chartConfig.yAxis={title:{text:""}}}h.initialize(c,e,j);var n=h.sortAxis(k,"ascending").getAxesElements(k);this.chartConfig.series.push({type:"pie",name:this.chartConfig.title.text,data:[]});_.each(n,function(p){_.each(p.observations,function(q){if(false===_.isUndefined(q.__cv_temporaryNewValue)){d=q.__cv_temporaryNewValue}else{d=q[j]}d=DataCube_Observation.parseValue(d);if(-1==$.inArray(p.self.__cv_niceLabel,o)){l.chartConfig.series[0].data.push([p.self.__cv_niceLabel,d]);l.chartConfig.colors.push(CubeViz_Visualization_Controller.getColor(p.self.__cv_uri));o.push(p.self.__cv_niceLabel)}else{return}})});return this};return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Polar=(function(b){__extends(a,b);function a(){b.apply(this,arguments)}return a})(CubeViz_Visualization_HighCharts_Chart);var CubeViz_Visualization_HighCharts_Spline=(function(a){__extends(b,a);function b(){a.apply(this,arguments)}return b})(CubeViz_Visualization_HighCharts_Chart);var DataCube_Component=(function(){function d(){}d.getDefaultSelectedDimensions=function b(k){var o=[];var k=JSON.parse(JSON.stringify(k));var m=0;var l=0;var g=0;var h=0;var n=0;var p={};var j={};_.each(k,function(q,i){o=[];l=0;h=_.keys(q.__cv_elements).length;g=1+Math.floor(_.keys(q.__cv_elements).length*0.3);g=10<g?10:1>g?1:g;do{n=Math.floor((Math.random()*h));if(-1===$.inArray(n,o)){if((o.length+1)<=g){o.push(n)}if(g==o.length){break}}l++}while((2*g)>l);j={};m=0;_.each(q.__cv_elements,function(r,s){if(-1<$.inArray(m,o)){j[m]=r}m++});q.__cv_elements=j;p[i]=q});return p};d.findDimensionElement=function c(i,h){var g=null;_.each(i,function(j){if(j.__cv_uri==h){g=j}});return g};d.loadAllAttributes=function f(i,k,g,j,h,l){$.ajax({url:i+"getcomponents",data:{serviceUrl:k,modelIri:g,dsdUrl:j,dsUrl:h,componentType:"attribute"}}).error(function(o,m,n){throw new Error("Attribute loadAll: "+o.responseText)}).success(function(m){if(false===_.isUndefined(m)&&false===_.isUndefined(m.content)){l(m.content)}})};d.loadAllDimensions=function a(i,k,g,j,h,l){$.ajax({url:i+"getcomponents",data:{serviceUrl:k,modelIri:g,dsdUrl:j,dsUrl:h,componentType:"dimension"}}).error(function(o,m,n){throw new Error("loadAllDimensions: "+o.responseText)}).success(function(m){if(false===_.isUndefined(m)&&false===_.isUndefined(m.content)){l(m.content)}})};d.loadAllMeasures=function e(i,k,g,j,h,l){$.ajax({url:i+"getcomponents",data:{serviceUrl:k,modelIri:g,dsdUrl:j,dsUrl:h,componentType:"measure"}}).error(function(o,m,n){throw new Error("loadAllMeasures: "+o.responseText)}).done(function(m){if(false===_.isUndefined(m)&&false===_.isUndefined(m.content)){l(m.content)}})};return d})();var DataCube_DataCubeMerger=(function(){function d(){}d.adaptDimensionElements=function j(n,m,l){var k=0;m=$.parseJSON(JSON.stringify(m));_.each(m,function(o){o["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]=n+"dimension"+l;o["http://purl.org/dc/terms/source"]=o.__cv_uri;if(false===_.isUndefined(o["http://www.w3.org/2002/07/owl#sameAs"])){o["http://www.w3.org/2002/07/owl#sameAs"]=[o["http://www.w3.org/2002/07/owl#sameAs"],o.__cv_uri]}else{o["http://www.w3.org/2002/07/owl#sameAs"]=o.__cv_uri}o.__cv_uri=n+"dimension"+l+"DimensionElement"+k;o.__cv_hashedUri=CryptoJS.MD5(o.__cv_uri)+"";++k});return m};d.buildDataSets=function h(m,l,k){return{0:{__cv_niceLabel:"Artifical Dataset","http://www.w3.org/2000/01/rdf-schema#label":"Merged DataSet",__cv_description:"This is an artifical data set and it consists of '"+l.__cv_niceLabel+"' and '"+k.__cv_niceLabel+"'",__cv_uri:m+"dataset",__cv_hashedUri:CryptoJS.MD5(m+"dataset")+"","http://purl.org/dc/terms/source":[l.__cv_uri,k.__cv_uri],"http://purl.org/dc/terms/created":(new Date()).toString(),"http://purl.org/linked-data/cube#structure":m+"dataStructureDefinition","http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#DataSet",__cv_sourceDataset:[l,k]}}};d.buildDataStructureDefinitions=function g(n,m){var l={0:{__cv_niceLabel:"Artifical Data Structure Definition","http://www.w3.org/2000/01/rdf-schema#label":"Artifical Data Structure Definition",__cv_description:"This is an artifical data structure definition created during a data cube merge.",__cv_uri:n+"dataStructureDefinition",__cv_hashedUri:CryptoJS.MD5(n+"dataStructureDefinition")+"","http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#DataStructureDefinition","http://purl.org/linked-data/cube#component":{0:n+"measure"},"http://purl.org/dc/terms/created":(new Date()).toString()}};var k=1;_.each(m,function(o){l[0]["http://purl.org/linked-data/cube#component"][k]=o.__cv_uri;++k});return l};d.buildDimensionsAndTheirComponentSpecifications=function e(o,n){var k={};var l=0;var m={};_.each(n,function(p){k={__cv_niceLabel:"Merged Component Specification of '"+p[0].__cv_niceLabel+"' and '"+p[1].__cv_niceLabel+"'","http://www.w3.org/2000/01/rdf-schema#label":"Merged Component Specification of '"+p[0].__cv_niceLabel+"' and '"+p[1].__cv_niceLabel+"'",__cv_description:"This Component Specification was merged and consists of '"+p[0].__cv_niceLabel+"' and '"+p[1].__cv_niceLabel+"'",__cv_uri:o+"componentSpecificationDimension"+l,__cv_hashedUri:CryptoJS.MD5(o+"componentSpecificationDimension"+l)+"","http://www.w3.org/2002/07/owl#sameAs":[p[0].__cv_uri,p[1].__cv_uri],"http://purl.org/dc/terms/source":[p[0].__cv_uri,p[1].__cv_uri],__cv_elements:{},__cv_oldCubeDimension:[p[0]["http://purl.org/linked-data/cube#dimension"],p[1]["http://purl.org/linked-data/cube#dimension"]],"http://purl.org/linked-data/cube#dimension":o+"dimension"+l,"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#ComponentSpecification","http://purl.org/dc/terms/created":(new Date()).toString(),__cv_sourceComponentSpecification:[p[0],p[1]]};k.__cv_elements=d.mergeDimensionElements(p[0].__cv_elements,p[1].__cv_elements);k.__cv_elements=d.adaptDimensionElements(o,k.__cv_elements,l);m[k.__cv_uri]=k;++l});return m};d.buildMeasure=function i(m,l,k){return{0:{__cv_niceLabel:"Artifical Measure of '"+l.__cv_niceLabel+"' and '"+k.__cv_niceLabel+"'","http://www.w3.org/2000/01/rdf-schema#label":"Artifical Measure of '"+l.__cv_niceLabel+"' and '"+k.__cv_niceLabel+"'",__cv_description:"This is an artifical measure and it consists of '"+l.__cv_niceLabel+"' and '"+k.__cv_niceLabel+"'",__cv_uri:m+"componentSpecificationMeasure",__cv_hashedUri:CryptoJS.MD5(m+"componentSpecificationMeasure")+"",__cv_oldCubeMeasure:[l["http://purl.org/linked-data/cube#measure"],k["http://purl.org/linked-data/cube#measure"]],"http://purl.org/linked-data/cube#measure":m+"measure","http://purl.org/dc/terms/source":[l.__cv_uri,k.__cv_uri],"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"http://purl.org/linked-data/cube#ComponentSpecification","http://purl.org/dc/terms/created":(new Date()).toString(),__cv_sourceMeasure:[l,k]}}};d.buildObservations=function f(w,q,o,r,p,m,l,x){var n={};var v=null;var y=0;var s={};var t={};var u=[];var k=null;r=$.parseJSON(JSON.stringify(r));p=$.parseJSON(JSON.stringify(p));_.each(r,function(z){t[z.__cv_uri]=z});_.each(p,function(z){t[z.__cv_uri]=z});_.each(t,function(z){z.__cv_sourceObservation=$.parseJSON(JSON.stringify(z));if(z["http://purl.org/linked-data/cube#dataSet"]==q.__cv_uri){z.__cv_sourceDataset=q}else{z.__cv_sourceDataset=o}z["http://www.w3.org/2002/07/owl#sameAs"]=z.__cv_uri;z["http://purl.org/dc/terms/source"]=z.__cv_uri;z.__cv_uri=w+"observation"+y;z.__cv_hashedUri=CryptoJS.MD5(z.__cv_uri)+"";z["http://purl.org/linked-data/cube#dataSet"]=w+"dataset";z["http://purl.org/dc/terms/created"]=(new Date()).toString();k=null;_.each(m.__cv_oldCubeMeasure,function(A){if(false===_.isUndefined(z[A])){k=A}});if(false===_.isNull(k)){z[w+"measure"]=z[k];delete z[k];n[z.__cv_uri]=z;++y}else{}});t={};_.each(l,function(z){_.each(n,function(A){v=null;_.each(z.__cv_elements,function(B){if(true===_.isArray(B["http://www.w3.org/2002/07/owl#sameAs"])){_.each(B["http://www.w3.org/2002/07/owl#sameAs"],function(C){_.each(z.__cv_oldCubeDimension,function(D){if(C==A[D]){v=B.__cv_uri}})})}else{_.each(z.__cv_oldCubeDimension,function(C){if(B["http://www.w3.org/2002/07/owl#sameAs"]==A[C]){v=B.__cv_uri}})}});if(false===_.isNull(v)){A[w+"dimension"+x]=v;_.each(z.__cv_oldCubeDimension,function(B){delete A[B]});t[A.__cv_uri]=A}else{u.push(A.__cv_uri)}});++x});n={};_.each(t,function(z){if(-1===$.inArray(z.__cv_uri,u)){n[z.__cv_uri]=z}});return n};d.generateMergedDataCubeUri=function a(k,l){return k+"go/mergeddatacube/"+(CryptoJS.MD5(l)+"").substring(0,6)+"#"};d.getDefaultDataCubeObject=function b(){return{components:{attributes:null,dimensions:{},measures:{}},dataSets:{},dataStructureDefinitions:{},numberOfMultipleDimensions:0,numberOfOneElementDimensions:0,retrievedObservations:{},selectedComponents:{},selectedDS:{},selectedDSD:{},selectedSlice:{},slices:{}}};d.mergeDimensionElements=function c(o,n){var m=0;var k={};var l=[];_.each(o,function(p){k[m++]=p;l.push(p.__cv_uri);if(false===_.isUndefined(p["http://www.w3.org/2002/07/owl#sameAs"])){l.push(p["http://www.w3.org/2002/07/owl#sameAs"])}});_.each(n,function(p){if(-1==$.inArray(p.__cv_uri,l)){if(false===_.isUndefined(p["http://www.w3.org/2002/07/owl#sameAs"])&&-1<$.inArray(p["http://www.w3.org/2002/07/owl#sameAs"],l)){return}k[m++]=p;l.push(p.__cv_uri)}});return k};return d})();var DataCube_DataSet=(function(){function a(){}a.loadAll=function b(d,f,c,e,g){$.ajax({url:d+"getdatasets/",data:{serviceUrl:f,modelIri:c,dsdUrl:e}}).error(function(j,h,i){throw new Error("loadAll error: "+j.responseText)}).success(function(h){if(false===_.isUndefined(h)&&false===_.isUndefined(h.content)){g(h.content)}})};return a})();var DataCube_DataStructureDefinition=(function(){function b(){}b.loadAll=function c(e,f,d,g){$.ajax({url:e+"getdatastructuredefinitions/",data:{serviceUrl:f,modelIri:d}}).error(function(j,h,i){throw new Error("loadAll error: "+j.responseText)}).done(function(h){b.prepareLoadedDataStructureDefinitions(h,g)})};b.prepareLoadedDataStructureDefinitions=function a(d,e){d=JSON.parse(d);d.sort(function(g,f){return g.label.toUpperCase().localeCompare(f.label.toUpperCase())});e(d)};return b})();var DataCube_Observation=(function(){function d(){this._axes={}}d.prototype.addAxisEntryPointsTo=function(i,j,g){var h=this;_.each(g,function(l,k){g[k]={value:l,ref:h._axes[k][l]}});this._axes[i][j].push(g)};d.prototype.getAxesElements=function(g){if(false===_.isUndefined(this._axes[g])){return this._axes[g]}else{return{}}};d.getUsedDimensionElementUris=function f(i,g){var h=[];_.each(i,function(j){if(-1===$.inArray(j[g],h)){h.push(j[g])}});return h};d.getValues=function b(k,i){var g=false;var j=null;var h=[];_.each(k,function(l){j=d.parseValue(l[i]);if(false===j){g=true;return}else{h.push(j)}});return[h,g]};d.prototype.initialize=function(n,g,k){var m={};var j="";var i={};var h=this;var l=0;this._axes={};_.each(n,function(o){l=d.parseValue(o[k]);if(false===l){return}_.each(g,function(p){j=p["http://purl.org/linked-data/cube#dimension"];i=o[j];if(true===_.isUndefined(h._axes[j])){h._axes[j]={}}if(true===_.isUndefined(h._axes[j][i])){m={__cv_uri:i,__cv_niceLabel:i};_.each(p.__cv_elements,function(q){if(q.__cv_uri==i){m=q}});h._axes[j][i]={observations:{},self:m}}h._axes[j][i].observations[o.__cv_uri]=o})});return this};d.loadAll=function e(h,j,g,i,k,l){$.ajax({url:h+"getobservations/",data:{serviceUrl:j,modelIri:g,cv_dataHash:i,datasetUri:k}}).error(function(o,m,n){throw new Error("Observation loadAll error: "+o.responseText)}).done(function(m){l(m.content)})};d.loadNumberOfObservations=function a(h,j,g,i,k){$.ajax({url:h+"getnumberofobservations/",data:{serviceUrl:j,modelIri:g,dsUri:i}}).error(function(n,l,m){throw new Error("Observation loadNumberOfObservations error: "+n.responseText)}).done(function(l){k(l.content)})};d.parseValue=function c(i){var g=null;try{if(true===_.str.include(i," ")){g=parseFloat(i.replace(/ /gi,""))}else{g=parseFloat(i)}if(false===_.isNaN(g)&&_.isFinite(g)){return g}}catch(h){return false}return false};d.prototype.sortAxis=function(i,k){var j=this._axes[i];var k=true===_.isUndefined(k)?"ascending":k;var l=[];var g={};var h=this;_.each(j,function(n,m){l.push({key:m,label:n.self.__cv_niceLabel})});switch(k){case"descending":l.sort(function(n,m){n=String(n.label).toLowerCase();m=String(m.label).toLowerCase();return((n>m)?-1:((n<m)?1:0))});break;default:l.sort(function(n,m){n=String(n.label).toLowerCase();m=String(m.label).toLowerCase();return((n<m)?-1:((n>m)?1:0))});break}_.each(l,function(m){g[m.key]=h._axes[i][m.key]});this._axes[i]=g;return this};return d})();var DataCube_Slice=(function(){function a(){}a.loadAll=function b(e,g,c,f,d,h){$.ajax({url:e+"getslices",data:{serviceUrl:g,modelIri:c,dsdUrl:f,dsUrl:d}}).error(function(k,i,j){throw new Error("DataCube_Slice > loadAll: "+k.responseText)}).success(function(i){if(false===_.isUndefined(i)&&false===_.isUndefined(i.content)){h(i.content)}})};return a})();var View_CompareAction_ModelSelection=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CompareAction_ModelSelection",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.handleModelSelectorChanges=function(d){var c=_.str.trim($("#cubeviz-compare-modelSelector"+d+" option:selected").text());var e=$("#cubeviz-compare-modelSelector"+d).val();if(""!=e){this.app._.compareAction.models[d]={__cv_compareNr:d,__cv_uri:e,__cv_niceLabel:c};this.triggerGlobalEvent("onSelect_model"+d);if(""!=this.app._.compareAction.models[1]&&""!=this.app._.compareAction.models[2]){this.triggerGlobalEvent("onSelect_model1AndModel2")}}else{this.app._.compareAction.models[d]=null;this.triggerGlobalEvent("onSelect_noModel"+d)}};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};b.prototype.onChange_modelSelector1=function(){this.handleModelSelectorChanges("1")};b.prototype.onChange_modelSelector2=function(){this.handleModelSelectorChanges("2")};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.bindUserInterfaceEvents({"change #cubeviz-compare-modelSelector1":this.onChange_modelSelector1,"change #cubeviz-compare-modelSelector2":this.onChange_modelSelector2});return this};return b})(CubeViz_View_Abstract);var View_CompareAction_DatasetSelection=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CompareAction_DatasetSelection",c,d);this.bindGlobalEvents([{name:"onReceive_datasets",handler:this.onReceive_datasets},{name:"onReceive_noDatasets",handler:this.onReceive_noDatasets},{name:"onSelect_model1",handler:this.onSelect_model1},{name:"onSelect_model2",handler:this.onSelect_model2},{name:"onSelect_noModel1",handler:this.onSelect_noModel1},{name:"onSelect_noModel2",handler:this.onSelect_noModel2},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.fillSelectBox=function(c,e){var d={};$(c).html('<option value="">- please select -</option>');_.each(e,function(f){d=$("<option/>");d.attr("value",f.__cv_uri).data("self",f).text(f.__cv_niceLabel);$(c).append(d)})};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};a.prototype.handleDatasetSelectorChanges=function(c,d){var e=$("#cubeviz-compare-datasetSelector"+c).val();if(true===_.str.isBlank(e)){this.app._.compareAction.datasets[c]=null;this.triggerGlobalEvent("onSelected_noDataset"+c)}else{d.__cv_compareNr=c;this.app._.compareAction.datasets[c]=d;this.triggerGlobalEvent("onSelected_dataset"+c)}if(false===_.isNull(this.app._.compareAction.datasets[1])&&false===_.isNull(this.app._.compareAction.datasets[2])){this.triggerGlobalEvent("onSelected_dataset1AndDataset2")}};a.prototype.handleModelSelectorChanges=function(d){var c=this;$("#cubeviz-compare-datasetSelectionDiv"+d).show();$("#cubeviz-compare-datasetSelector"+d).html('<option value="">please wait ... </option>');DataCube_DataSet.loadAll(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,"",function(e){c.onReceive_datasets(e,d)})};a.prototype.onReceive_datasets=function(c,e){var d=this;$("#cubeviz-compare-datasetSelectorWarningBox"+e).hide();if(0<_.size(c)){d.fillSelectBox("#cubeviz-compare-datasetSelector"+e,c)}else{$("#cubeviz-compare-datasetSelector"+e).html('<option value="">Choose another model ... </option>');d.triggerGlobalEvent("onReceive_noDatasets",{modelNr:e,modelUri:d.app._.compareAction.models[e].__cv_uri})}};a.prototype.onReceive_noDatasets=function(c,d){$("#cubeviz-compare-datasetSelectorWarningBox"+d.modelNr).show()};a.prototype.onSelect_dataset1=function(c){this.handleDatasetSelectorChanges("1",$(c.target).find("option:selected").data("self"))};a.prototype.onSelect_dataset2=function(c){this.handleDatasetSelectorChanges("2",$(c.target).find("option:selected").data("self"))};a.prototype.onSelect_model1=function(c,d){this.handleModelSelectorChanges("1")};a.prototype.onSelect_model2=function(c,d){this.handleModelSelectorChanges("2")};a.prototype.onSelect_noModel1=function(){$("#cubeviz-compare-datasetSelectionDiv1").hide()};a.prototype.onSelect_noModel2=function(){$("#cubeviz-compare-datasetSelectionDiv2").hide()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({"change #cubeviz-compare-datasetSelector1":this.onSelect_dataset1,"change #cubeviz-compare-datasetSelector2":this.onSelect_dataset2});return this};return a})(CubeViz_View_Abstract);var View_CompareAction_GeneralDatasetInformation=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CompareAction_GeneralDatasetInformation",c,d);this.bindGlobalEvents([{name:"onReceived_attributes1AndAttributes2",handler:this.onReceived_attributes1AndAttributes2},{name:"onReceived_dimensions1AndDimensions2",handler:this.onReceived_dimensions1AndDimensions2},{name:"onReceived_measures1AndMeasures2",handler:this.onReceived_measures1AndMeasures2},{name:"onReceived_numbersOfObservations1AndNumbersOfObservations2",handler:this.onReceived_numbersOfObservations1AndNumbersOfObservations2},{name:"onReceived_slices1AndSlices2",handler:this.onReceived_slices1AndSlices2},{name:"onSelected_dataset1",handler:this.onSelected_dataset1},{name:"onSelected_dataset2",handler:this.onSelected_dataset2},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.displayAttributesInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(3)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.attributes[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayAttributesInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(3)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.attributes[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displayDimensionsInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(0)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.dimensions[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayDimensionsInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(0)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.dimensions[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displayDimensionElementsInformation1=function(){var e=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");var c=0;var d=this;_.each(this.app._.compareAction.components.dimensions[1],function(f){c+=_.size(f.__cv_elements)});$($(e.get(1)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(c);$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayDimensionElementsInformation2=function(){var e=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");var c=0;var d=this;_.each(this.app._.compareAction.components.dimensions[2],function(f){_.each(f.__cv_elements,function(g){++c})});$($(e.get(1)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(c);$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayMeasuresInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(2)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.measures[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayMeasuresInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(2)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.components.measures[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displayNumberOfObservations1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(5)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(this.app._.compareAction.numberOfObservations[1]);$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displayNumberOfObservations2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(5)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(this.app._.compareAction.numberOfObservations[2]);$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.displaySlicesInformation1=function(){var c=$("#cubeviz-compare-generalDatasetInformation1").find(".cubeviz-compare-informationPieceBox");$($(c.get(4)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.slices[1]));$("#cubeviz-compare-generalDatasetInformation1").show()};a.prototype.displaySlicesInformation2=function(){var c=$("#cubeviz-compare-generalDatasetInformation2").find(".cubeviz-compare-informationPieceBox");$($(c.get(4)).find(".cubeviz-compare-informationPieceBoxValue").first()).html(_.size(this.app._.compareAction.slices[2]));$("#cubeviz-compare-generalDatasetInformation2").show()};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};a.prototype.handleDatasetSelectorChanges=function(d){var c=this;this.app._.compareAction.components.dimensions[d]=null;this.app._.compareAction.components.measures[d]=null;this.app._.compareAction.components.attributes[d]=null;DataCube_Component.loadAllDimensions(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.components.dimensions[d]=e;c.triggerGlobalEvent("onReceived_dimensions"+d);if(false===_.isNull(c.app._.compareAction.components.dimensions[1])&&false===_.isNull(c.app._.compareAction.components.dimensions[2])){c.triggerGlobalEvent("onReceived_dimensions1AndDimensions2")}});DataCube_Component.loadAllMeasures(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.components.measures[d]=e;c.triggerGlobalEvent("onReceived_measures"+d);if(false===_.isNull(c.app._.compareAction.components.measures[1])&&false===_.isNull(c.app._.compareAction.components.measures[2])){c.triggerGlobalEvent("onReceived_measures1AndMeasures2")}});DataCube_Component.loadAllAttributes(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.components.attributes[d]=e;c.triggerGlobalEvent("onReceived_attributes"+d);if(false===_.isNull(c.app._.compareAction.components.measures[1])&&false===_.isNull(c.app._.compareAction.components.measures[2])){c.triggerGlobalEvent("onReceived_attributes1AndAttributes2")}});DataCube_Slice.loadAll(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d]["http://purl.org/linked-data/cube#structure"],this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.slices[d]=e;c.triggerGlobalEvent("onReceived_slices"+d);if(false===_.isNull(c.app._.compareAction.slices[1])&&false===_.isNull(c.app._.compareAction.slices[2])){c.triggerGlobalEvent("onReceived_slices1AndSlices2")}});DataCube_Observation.loadNumberOfObservations(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.numberOfObservations[d]=e;c.triggerGlobalEvent("onReceived_observationNumber"+d);if(-1<c.app._.compareAction.numberOfObservations[1]&&-1<c.app._.compareAction.numberOfObservations[2]){c.triggerGlobalEvent("onReceived_numbersOfObservations1AndNumbersOfObservations2")}});DataCube_Observation.loadAll(this.app._.backend.url,"",this.app._.compareAction.models[d].__cv_uri,"",this.app._.compareAction.datasets[d].__cv_uri,function(e){c.app._.compareAction.retrievedObservations[d]=e;c.triggerGlobalEvent("onReceived_observations"+d);if(false==_.isNull(c.app._.compareAction.retrievedObservations[1])&&false==_.isNull(c.app._.compareAction.retrievedObservations[2])){c.triggerGlobalEvent("onReceived_observations1AndObservations2")}})};a.prototype.onSelected_dataset1=function(c){this.handleDatasetSelectorChanges("1")};a.prototype.onSelected_dataset2=function(c){this.handleDatasetSelectorChanges("2")};a.prototype.onReceived_attributes1AndAttributes2=function(){this.displayAttributesInformation1();this.displayAttributesInformation2()};a.prototype.onReceived_dimensions1AndDimensions2=function(){this.displayDimensionsInformation1();this.displayDimensionsInformation2();this.displayDimensionElementsInformation1();this.displayDimensionElementsInformation2()};a.prototype.onReceived_measures1AndMeasures2=function(){this.displayMeasuresInformation1();this.displayMeasuresInformation2()};a.prototype.onReceived_numbersOfObservations1AndNumbersOfObservations2=function(){this.displayNumberOfObservations1();this.displayNumberOfObservations2()};a.prototype.onReceived_slices1AndSlices2=function(){this.displaySlicesInformation1();this.displaySlicesInformation2()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return a})(CubeViz_View_Abstract);var View_CompareAction_DimensionOverview=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CompareAction_DimensionOverview",c,d);this.bindGlobalEvents([{name:"onReceived_dimensions1AndDimensions2",handler:this.onReceived_dimensions1AndDimensions2},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.displayEqualDimensions=function(){var j="";var g=null;var f=null;var d=0;var e=0;var h=2000;var c=this;if(0<_.size(this.app._.compareAction.equalDimensions)){$("#cubeviz-compare-equalDimensions1").show();$("#cubeviz-compare-equalDimensions2").show();$("#cubeviz-compare-equalDimensionsTableContainer1").html("");$("#cubeviz-compare-equalDimensionsTableContainer2").html("");_.each(this.app._.compareAction.equalDimensions,function(i){j=i[0].__cv_description;if(true===_.str.isBlank(j)){j="no description found"}g=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-equalDimension").html(),{dimensionLabel:i[0].__cv_niceLabel,dimensionDescription:j}));if(false===_.isUndefined(i[0].__cv_equalElements)&&0<_.size(i[0].__cv_equalElements)){f=$($(g).find(".cubeviz-compare-dimensionTitleAndElements").first());f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">Dimension Elements</div></td>'));_.each(i[0].__cv_equalElements,function(k){f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">'+k.__cv_niceLabel+"</div></td>"))});$($(g).find(".cubeviz-compare-dimensionNumberOfUnequalDimensionElements").first()).html(_.size(i[0].__cv_elements)-_.size(i[0].__cv_equalElements));$($(g).find(".cubeviz-compare-dimensionNumberOfEqualDimensionElements").first()).html(_.size(i[0].__cv_equalElements))}$("#cubeviz-compare-equalDimensionsTableContainer1").append(g);j=i[1].__cv_description;if(true===_.str.isBlank(j)){j="no description found"}g=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-equalDimension").html(),{dimensionLabel:i[1].__cv_niceLabel,dimensionDescription:j}));if(false===_.isUndefined(i[1].__cv_equalElements)&&0<_.size(i[1].__cv_equalElements)){f=$($(g).find(".cubeviz-compare-dimensionTitleAndElements").first());f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">Dimension Elements</div></td>'));_.each(i[1].__cv_equalElements,function(k){f.append($('<td rowspan="3" style="vertical-align: middle;"><div style="-webkit-transform:rotate(-90deg);">'+k.__cv_niceLabel+"</div></td>"))});$($(g).find(".cubeviz-compare-dimensionNumberOfUnequalDimensionElements").first()).html(_.size(i[1].__cv_elements)-_.size(i[1].__cv_equalElements));$($(g).find(".cubeviz-compare-dimensionNumberOfEqualDimensionElements").first()).html(_.size(i[1].__cv_equalElements))}$("#cubeviz-compare-equalDimensionsTableContainer2").append(g);h+=1000});$("#cubeviz-compare-equalDimensionsTableContainer1").width(h);$("#cubeviz-compare-equalDimensionsTableContainer2").width(h)}};a.prototype.displayUnequalDimensions=function(){var e=null;var d="";var c=0;$("#cubeviz-compare-unequalDimensionsTableContainer1").html("");if(0<_.size(this.app._.compareAction.unequalDimensions[1])||0<_.size(this.app._.compareAction.unequalDimensions[2])){$("#cubeviz-compare-unequalDimensions1").show();$("#cubeviz-compare-unequalDimensions2").show()}_.each(this.app._.compareAction.unequalDimensions[1],function(f){d=f.__cv_description;if(true===_.str.isBlank(d)){d="no description found"}e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-unequalDimension").html(),{dimensionLabel:f.__cv_niceLabel,dimensionDescription:d}));$(e.find(".cubeviz-compare-numberOfDimensionElements").first()).html(_.size(f.__cv_elements));$("#cubeviz-compare-unequalDimensionsTableContainer1").append(e);c+=220});$(".cubeviz-compare-unequalDimensions").css("min-width",c);_.each(this.app._.compareAction.unequalDimensions[2],function(f){d=f.__cv_description;if(true===_.str.isBlank(d)){d="no description found"}e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-compare-tpl-unequalDimension").html(),{dimensionLabel:f.__cv_niceLabel,dimensionDescription:d}));$(e.find(".cubeviz-compare-numberOfDimensionElements").first()).html(_.size(f.__cv_elements));$("#cubeviz-compare-unequalDimensionsTableContainer2").append(e)})};a.prototype.findEqualDimensions=function(){var g=null;var e=null;var d=this;var f={};var c=[];d.app._.compareAction.equalDimensions=[];d.app._.compareAction.unequalDimensions={1:[],2:[]};_.each(this.app._.compareAction.components.dimensions[1],function(h){f[h.__cv_uri]=h.__cv_uri;if(false===_.str.isBlank(h["http://www.w3.org/2002/07/owl#sameAs"])){f[h["http://www.w3.org/2002/07/owl#sameAs"]]=h.__cv_uri}});_.each(this.app._.compareAction.components.dimensions[2],function(h){if(false===_.isUndefined(f[h.__cv_uri])||false===_.isUndefined(f[h["http://www.w3.org/2002/07/owl#sameAs"]])){if(false===_.isUndefined(f[h.__cv_uri])){e=d.app._.compareAction.components.dimensions[1][f[h.__cv_uri]]}else{e=d.app._.compareAction.components.dimensions[1][f[h["http://www.w3.org/2002/07/owl#sameAs"]]]}g=d.findEqualDimensionElements(e,h);e.__cv_equalElements=g[1];h.__cv_equalElements=g[2];d.app._.compareAction.equalDimensions.push([e,h]);c.push(e.__cv_uri)}else{d.app._.compareAction.unequalDimensions[2].push(h)}});_.each(this.app._.compareAction.components.dimensions[1],function(h){if(-1===$.inArray(h.__cv_uri,c)){d.app._.compareAction.unequalDimensions[1].push(h)}});if(0<_.size(this.app._.compareAction.equalDimensions)){this.triggerGlobalEvent("onFound_equalDimensions")}};a.prototype.findEqualDimensionElements=function(e,d){var c={1:[],2:[]};var f={};if(0==_.size(e.__cv_elements)||0==_.size(d.__cv_elements)){return c}_.each(e.__cv_elements,function(g){f[g.__cv_uri]=g;if(false===_.str.isBlank(g["http://www.w3.org/2002/07/owl#sameAs"])){f[g["http://www.w3.org/2002/07/owl#sameAs"]]=g}});_.each(d.__cv_elements,function(g){if(false===_.isUndefined(f[g.__cv_uri])){c[1].push(f[g.__cv_uri]);c[2].push(g)}if(false===_.isUndefined(f[g["http://www.w3.org/2002/07/owl#sameAs"]])){c[1].push(f[g["http://www.w3.org/2002/07/owl#sameAs"]]);c[2].push(g)}});return c};a.prototype.onReceived_dimensions1AndDimensions2=function(c){this.findEqualDimensions();this.displayUnequalDimensions();this.displayEqualDimensions()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return a})(CubeViz_View_Abstract);var View_CompareAction_MeasureAndAttributeInformation=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CompareAction_MeasureAndAttributeInformation",c,d);this._measures1And2Recveived=false;this._observations1And2Received=false;this.bindGlobalEvents([{name:"onReceived_measures1AndMeasures2",handler:this.onReceived_measures1AndMeasures2},{name:"onReceived_observations1AndObservations2",handler:this.onReceived_observations1AndObservations2},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.displayMeasuresAndAttributesInformation=function(e){var h=$("#cubeviz-compare-measuresAndAttributesInformation"+e);var f=false;var g=this.app._.compareAction.components.measures[e][Object.keys(this.app._.compareAction.components.measures[e])[0]];var c=null;var d=null;d=DataCube_Observation.getValues(this.app._.compareAction.retrievedObservations[e],g["http://purl.org/linked-data/cube#measure"]);c=d[0];f=d[1];if(true===f){$("#cubeviz-compare-mAAInvalidNumbersFound"+e).show()}$(h.find(".cubeviz-compare-mAARangeMin").first()).html(true===f?"~ "+String(jsStats.min(c)).substring(0,10):String(jsStats.min(c)).substring(0,10));$(h.find(".cubeviz-compare-mAARangeMax").first()).html(true===f?"~ "+String(jsStats.max(c)).substring(0,10):String(jsStats.max(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAMedian").first()).html(true===f?"~ "+String(jsStats.median(c)).substring(0,10):String(jsStats.median(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAMean").first()).html(true===f?"~ "+String(jsStats.mean(c)).substring(0,10):String(jsStats.mean(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAVariance").first()).html(true===f?"~ "+String(jsStats.variance(c)).substring(0,10):String(jsStats.variance(c)).substring(0,10));$(h.find(".cubeviz-compare-mAAStandardDeviation").first()).html(true===f?"~ "+String(jsStats.standardDeviation(c)).substring(0,10):String(jsStats.standardDeviation(c)).substring(0,10));$("#cubeviz-compare-measuresAndAttributesInformation"+e).show()};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};b.prototype.onReceived_measures1AndMeasures2=function(){this._measures1And2Recveived=true;if(true===this._measures1And2Recveived&&true===this._observations1And2Received){this.displayMeasuresAndAttributesInformation(1);this.displayMeasuresAndAttributesInformation(2)}};b.prototype.onReceived_observations1AndObservations2=function(){this._observations1And2Received=true;if(true===this._measures1And2Recveived&&true===this._observations1And2Received){this.displayMeasuresAndAttributesInformation(1);this.displayMeasuresAndAttributesInformation(2)}};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return b})(CubeViz_View_Abstract);var View_CompareAction_VisualizationSetup=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CompareAction_VisualizationSetup",c,d);this._equalDimensionsFound=false;this._measuresReceived=false;this._observationsReceived=false;this.bindGlobalEvents([{name:"onFound_equalDimensions",handler:this.onFound_equalDimensions},{name:"onReceived_measures1AndMeasures2",handler:this.onReceived_measures1AndMeasures2},{name:"onReceived_observations1AndObservations2",handler:this.onReceived_observations1AndObservations2},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.checkAndCreateMergedDataCube=function(){if(false===this._equalDimensionsFound||false===this._measuresReceived||false===this._observationsReceived){return}var d="";var l=0;var e=0;var k=null;var h=null;var c={};var f="";var g=null;var j=this;var i=[];c=DataCube_DataCubeMerger.getDefaultDataCubeObject();f=DataCube_DataCubeMerger.generateMergedDataCubeUri(this.app._.backend.url,JSON.stringify(this.app._.compareAction));c.dataSets=DataCube_DataCubeMerger.buildDataSets(f,this.app._.compareAction.datasets[1],this.app._.compareAction.datasets[2]);c.selectedDS=c.dataSets[0];c.components.dimensions=DataCube_DataCubeMerger.buildDimensionsAndTheirComponentSpecifications(f,this.app._.compareAction.equalDimensions);c.selectedComponents.dimensions=c.components.dimensions;c.numberOfMultipleDimensions=_.size(CubeViz_Visualization_Controller.getMultipleDimensions(c.components.dimensions));c.numberOfOneElementDimensions=_.size(CubeViz_Visualization_Controller.getOneElementDimensions(c.components.dimensions));k=this.app._.compareAction.components.measures[1][Object.keys(this.app._.compareAction.components.measures[1])[0]];h=this.app._.compareAction.components.measures[2][Object.keys(this.app._.compareAction.components.measures[2])[0]];c.components.measures=DataCube_DataCubeMerger.buildMeasure(f,k,h);c.selectedComponents.measure=c.components.measures[0];c.dataStructureDefinitions=DataCube_DataCubeMerger.buildDataStructureDefinitions(f,c.components.dimensions);c.selectedDSD=c.dataStructureDefinitions[0];c.retrievedObservations=DataCube_DataCubeMerger.buildObservations(f,j.app._.compareAction.datasets[1],j.app._.compareAction.datasets[2],j.app._.compareAction.retrievedObservations[1],j.app._.compareAction.retrievedObservations[2],c.selectedComponents.measure,c.selectedComponents.dimensions,l++);console.log("");console.log("mergedDataCube for "+_.size(this.app._.compareAction.equalDimensions)+" equal dimensions:");console.log("");console.log(c);CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,c,"data",function(n){console.log("");console.log("generated hash: "+n);var m=j.app._.backend.url+"?";if(false===_.isNull(j.app._.backend.serviceUrl)){m+="serviceUrl="+encodeURIComponent(j.app._.backend.serviceUrl)+"&"}if(true===_.str.isBlank(j.app._.backend.modelUrl)){m+="m="+encodeURIComponent(j.app._.compareAction.models[1].__cv_uri)}else{m+="m="+encodeURIComponent(j.app._.backend.modelUrl)}m+="&cv_dataHash="+n;$("#cubeviz-compare-visualizeLink").attr("href",m).show()},true)};b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.render()};b.prototype.onFound_equalDimensions=function(){this._equalDimensionsFound=true;this.checkAndCreateMergedDataCube()};b.prototype.onReceived_measures1AndMeasures2=function(){this._measuresReceived=true;this.checkAndCreateMergedDataCube()};b.prototype.onReceived_observations1AndObservations2=function(){this._observationsReceived=true;this.checkAndCreateMergedDataCube()};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.bindUserInterfaceEvents({});return this};return b})(CubeViz_View_Abstract);var View_DataselectionModule_DataSet=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_DataSet",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-dataSet-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.dataSets);this.render()};a.prototype.onClick_closeAndUpdate=function(h){var f=$(h.target).data("dialogDiv");var e=new CubeViz_Collection("__cv_uri");var g=$("input[name=cubeviz-dataSelectionModule-dataSetRadio]:checked").val();var c=null;var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(f);CubeViz_View_Helper.showLeftSidebarSpinner();c=e.addList(this.app._.data.dataSets).get(g);this.app._.data.selectedDS=c;CubeViz_View_Helper.hideCloseAndUpdateSpinner(f);CubeViz_View_Helper.closeDialog(f);$("#cubeviz-dataSet-label").html(_.str.prune(c.__cv_niceLabel,24,".."));this.app._.data.retrievedObservations={};_.each(this.app._.data.dataStructureDefinitions,function(j){if(j.__cv_uri==c["http://purl.org/linked-data/cube#structure"]){d.app._.data.selectedDSD=j}});var i={callback:function(){d.triggerGlobalEvent("onReRender_visualization")}};this.triggerGlobalEvent("onChange_selectedDS",i)};a.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-dataSet").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;_.each(d,function(f){if(c.app._.data.selectedDS.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}});CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-dataSet"))};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"dataSet",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-dataSet");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_dataSet");$("#cubeviz-dataSet-label").html(_.str.prune(this.app._.data.selectedDS.__cv_niceLabel,24,"..")).attr("title",this.app._.data.selectedDS.__cv_niceLabel);if(1===_.size(this.app._.data.dataSets)){$("#cubeviz-dataSet-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogTitle").html(),__cv_hashedUri:"dataSet",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-dataSetHelpDialogDescription").html(),__cv_title:""}));var f=$("#cubeviz-dataSelectionModule-dialog-dataSet");CubeViz_View_Helper.attachDialogTo(f,{closeOnEscape:true,showCross:true,width:650});$(f.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-dataSet-dialogOpener").data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",f).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",f).data("type","alphabet");$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var e=new CubeViz_Collection("__cv_uri");var d=null;var c=$(f.find(".cubeviz-dataSelectionModule-dialogElements")[0]);e.addList(this.app._.data.dataSets).sortAscendingBy("__cv_niceLabel").each(function(g){d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:g.__cv_niceLabel,__cv_uri:g.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-dataSetRadio",radioName:"cubeviz-dataSelectionModule-dataSetRadio",radioValue:g.__cv_uri}));c.append(d)});this.bindUserInterfaceEvents({"click #cubeviz-dataSet-dialogOpener":this.onClick_dialogOpener});$("#cubeviz-dataSet-dialogOpener").show()}this.triggerGlobalEvent("onAfterRender_dataSet");this.bindUserInterfaceEvents({"click #cubeviz-dataSet-questionmark":this.onClick_questionmark});return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Slice=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Slice",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.slices);this.render()};a.prototype.onChange_selectedDS=function(){var c=this;DataCube_Slice.loadAll(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(d){c.app._.data.slices=d;if(0===_.keys(d).length){}else{c.app._.data.selectedSlice={}}})};a.prototype.onClick_closeAndUpdate=function(f){var e=$(f.target).data("dialogDiv");var h=new CubeViz_Collection("__cv_uri");var c=$("input[name=cubeviz-dataSelectionModule-sliceRadio]:checked").val();var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(e);if("noSlice"==c){this.app._.data.selectedSlice={};$("#cubeviz-slice-label").html(_.str.prune($("#cubeviz-dataSelectionModule-tra-sliceNoSelection").html(),24,".."))}else{this.app._.data.selectedSlice=h.addList(this.app._.data.slices).get(c);$("#cubeviz-slice-label").html(_.str.prune(this.app._.data.selectedSlice.__cv_niceLabel,24,".."))}CubeViz_View_Helper.hideCloseAndUpdateSpinner(e);CubeViz_View_Helper.closeDialog(e);var g={callback:function(){d.triggerGlobalEvent("onReRender_visualization")}};this.triggerGlobalEvent("onChange_selectedSlice",g)};a.prototype.onClick_dialogOpener=function(c){CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-slice"))};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"slice",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-sliceHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-slice");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_slice");var d="";var h="";var c=this;if(0===_.size(this.app._.data.slices)){$("#cubeviz-dataSelectionModule-sliceBlock").hide()}else{$("#cubeviz-dataSelectionModule-sliceBlock").show();if(0===_.keys(this.app._.data.selectedSlice).length){d=$("#cubeviz-dataSelectionModule-tra-sliceNoSelection").html()}else{d=this.app._.data.selectedComponents.attribute.__cv_niceLabel;h=this.app._.data.selectedComponents.attribute.__cv_description}$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogTitle").html(),__cv_hashedUri:"slice",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-sliceDialogDescription").html(),__cv_title:""}));var g=$("#cubeviz-dataSelectionModule-dialog-slice");CubeViz_View_Helper.attachDialogTo(g,{closeOnEscape:true,showCross:true,width:650});$(g.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(g.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(g.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-slice-dialogOpener").data("dialogDiv",g);$($(g.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",g);$($(g.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",g).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",g).data("type","alphabet");$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(g.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var f=null;var e=$(g.find(".cubeviz-dataSelectionModule-dialogElements")[0]);f=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogNoSliceSelectionElement").html(),__cv_uri:"__cv_noSlice",radioCSSClass:"cubeviz-dataSelectionModule-sliceRadio",radioName:"cubeviz-dataSelectionModule-sliceRadio",radioValue:"noSlice"}));if(0===_.size(this.app._.data.selectedSlice)){$(f.children().first()).attr("checked",true)}$(f.children().last()).css("font-weight","bold");e.append(f);this.collection.sortAscendingBy("__cv_niceLabel").each(function(i){f=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:i.__cv_niceLabel,__cv_uri:i.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-sliceRadio",radioName:"cubeviz-dataSelectionModule-sliceRadio",radioValue:i.__cv_uri}));if(i.__cv_uri==c.app._.data.selectedSlice.__cv_uri){$(f.children().first()).attr("checked",true)}e.append(f)});this.bindUserInterfaceEvents({"click #cubeviz-slice-dialogOpener":this.onClick_dialogOpener})}$("#cubeviz-slice-label").html(_.str.prune(d,24,"..")).attr("title",d);$("#cubeviz-slice-description").html(_.str.prune(h,55,"..")).attr("title",h);this.triggerGlobalEvent("onAfterRender_slice");this.bindUserInterfaceEvents({"click #cubeviz-slice-questionmark":this.onClick_questionmark});return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Measure=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Measure",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-measure-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.components.measures);this.render()};a.prototype.onChange_selectedDS=function(d){var c=this;DataCube_Component.loadAllMeasures(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.measures=e;if(0===_.keys(e).length){throw new Error("Error: There are no measures in the selected data set!")}else{c.app._.data.selectedComponents.measure=e[_.keys(e)[0]]}})};a.prototype.onClick_closeAndUpdate=function(g){var f=$(g.target).data("dialogDiv");var h=new CubeViz_Collection("__cv_uri");var e=$("input[name=cubeviz-dataSelectionModule-measureRadio]:checked").val();var c=null;var d=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(f);CubeViz_View_Helper.showLeftSidebarSpinner();c=h.addList(this.app._.data.components.measures).get(e);this.app._.data.selectedComponents.measure=c;CubeViz_View_Helper.hideCloseAndUpdateSpinner(f);CubeViz_View_Helper.closeDialog(f);$("#cubeviz-measure-label").html(_.str.prune(c.__cv_niceLabel,24,".."));CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(i){DataCube_Observation.loadAll(d.app._.backend.url,d.app._.backend.serviceUrl,d.app._.backend.modelUrl,i,"",function(j){d.app._.data.retrievedObservations=j;d.triggerGlobalEvent("onChange_selectedMeasure");d.triggerGlobalEvent("onReRender_visualization");CubeViz_View_Helper.hideLeftSidebarSpinner()});d.app._.backend.dataHash=i})};a.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-measure").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;if(1==d.length){$($(d.first()).children().first()).attr("checked",true)}else{_.each(d,function(f){if(c.app._.data.selectedComponents.measure.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}})}CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-measure"))};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_measure");$("#cubeviz-measure-label").html(_.str.prune(this.app._.data.selectedComponents.measure.__cv_niceLabel,24,"..")).attr("title",this.app._.data.selectedComponents.measure.__cv_niceLabel);$("#cubeviz-measure-description").html(_.str.prune(this.app._.data.selectedComponents.measure.__cv_description,55,"..")).attr("title",this.app._.data.selectedComponents.measure.__cv_description);if(1==_.keys(this.app._.data.components.measures).length){$("#cubeviz-measure-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-measureDialogTitle").html(),__cv_hashedUri:"measure",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-measureDialogDescription").html(),__cv_title:""}));var e=$("#cubeviz-dataSelectionModule-dialog-measure");CubeViz_View_Helper.attachDialogTo(e,{closeOnEscape:true,showCross:true,width:650});$(e.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(e.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-measure-dialogOpener").data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",e).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",e).data("type","alphabet");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var f=new CubeViz_Collection("__cv_uri");var d=null;var c=$(e.find(".cubeviz-dataSelectionModule-dialogElements")[0]);f.addList(this.app._.data.components.measures).sortAscendingBy("__cv_niceLabel").each(function(g){d=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:g.__cv_niceLabel,__cv_uri:g.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-measureRadio",radioName:"cubeviz-dataSelectionModule-measureRadio",radioValue:g.__cv_uri}));c.append(d)});this.bindUserInterfaceEvents({"click #cubeviz-measure-dialogOpener":this.onClick_dialogOpener})}this.triggerGlobalEvent("onAfterRender_measure");return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Attribute=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CubeVizModule_Attribute",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);$("#cubeviz-attribute-dialogOpener").off();CubeViz_View_Helper.destroyDialog($("#cubeviz-dataSelectionModule-dialog-attribute"));$("#cubeviz-dataSelectionModule-dialog-attribute").remove();return this};b.prototype.initialize=function(){this.collection.reset("__cv_uri");this.collection.addList(this.app._.data.components.attributes);this.render()};b.prototype.onChange_selectedDS=function(d){var c=this;DataCube_Component.loadAllAttributes(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.attributes=e;if(0===_.keys(e).length){}else{c.app._.data.selectedComponents.attribute=e[_.keys(e)[0]]}c.destroy().initialize()})};b.prototype.onClick_closeAndUpdate=function(h){var g=$(h.target).data("dialogDiv");var f=new CubeViz_Collection("__cv_uri");var c=$("input[name=cubeviz-dataSelectionModule-attributeRadio]:checked").val();var d=null;var e=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(g);CubeViz_View_Helper.showLeftSidebarSpinner();if("noAttribute"==c){this.app._.data.selectedComponents.attribute=null;$("#cubeviz-attribute-label").html(_.str.prune($("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedLabel").html(),24,"..")).attr("title",$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedLabel").html());$("#cubeviz-attribute-description").html(_.str.prune($("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedDescription").html(),55,"..")).attr("title",$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedDescription").html())}else{d=f.addList(this.app._.data.components.attributes).get(c);this.app._.data.selectedComponents.attribute=d;$("#cubeviz-attribute-label").html(_.str.prune(d.__cv_niceLabel,24,".."))}CubeViz_View_Helper.hideCloseAndUpdateSpinner(g);CubeViz_View_Helper.closeDialog(g);CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(i){DataCube_Observation.loadAll(e.app._.backend.url,e.app._.backend.serviceUrl,e.app._.backend.modelUrl,i,"",function(j){e.app._.data.retrievedObservations=j;e.triggerGlobalEvent("onChange_selectedAttribute");e.triggerGlobalEvent("onReRender_visualization");CubeViz_View_Helper.hideLeftSidebarSpinner()});e.app._.backend.dataHash=i})};b.prototype.onClick_dialogOpener=function(e){var d=$($("#cubeviz-dataSelectionModule-dialog-attribute").find(".cubeviz-dataSelectionModule-dialogElements").get(0)).children();var c=this;if(false===_.isUndefined(this.app._.data.selectedComponents.attribute)&&false===_.isNull(this.app._.data.selectedComponents.attribute)){_.each(d,function(f){if(c.app._.data.selectedComponents.attribute.__cv_uri==$($(f).children().first()).val()){$($(f).children().first()).attr("checked",true)}})}CubeViz_View_Helper.openDialog($("#cubeviz-dataSelectionModule-dialog-attribute"))};b.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"attributeAndMeasure",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-attributeAndMeasureHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-attributeAndMeasureHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-attributeAndMeasure");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_attribute");var i=false;var c="";var g="";if(0===_.size(this.app._.data.components.attributes)){c="[no attribute found]";i=true;$("#cubeviz-dataSelectionModule-attributeBlock").hide()}else{if(0<_.size(this.app._.data.components.attributes)&&(true===_.isUndefined(this.app._.data.selectedComponents.attribute)||true===_.isNull(this.app._.data.selectedComponents.attribute))){c=$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedLabel").html();g=$("#cubeviz-dataSelectionModule-tra-attributeDialogNoAttributeSelectedDescription").html()}else{c=this.app._.data.selectedComponents.attribute.__cv_niceLabel;g=this.app._.data.selectedComponents.attribute.__cv_description}}$("#cubeviz-attribute-label").html(_.str.prune(c,24,"..")).attr("title",c);$("#cubeviz-attribute-description").html(_.str.prune(g,55,"..")).attr("title",g);if(false===i){if(0==_.size(this.app._.data.components.attributes)){$("#cubeviz-attribute-dialogOpener").hide()}else{$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-attributeDialogTitle").html(),__cv_hashedUri:"attribute",__cv_description:"",__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-attributeDialogDescription").html(),__cv_title:""}));var f=$("#cubeviz-dataSelectionModule-dialog-attribute");CubeViz_View_Helper.attachDialogTo(f,{closeOnEscape:true,showCross:true,width:650});$(f.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-dialogSortButtons").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(f.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide();$("#cubeviz-attribute-dialogOpener").data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",f);$($(f.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",f).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",f).data("type","alphabet");$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).hide();$($(f.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).hide();var h=new CubeViz_Collection("__cv_uri");var e=null;var d=$(f.find(".cubeviz-dataSelectionModule-dialogElements")[0]);e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-sliceDialogNoSliceSelectionElement").html(),__cv_uri:"__cv_noAttribute",radioCSSClass:"cubeviz-dataSelectionModule-attributeRadio",radioName:"cubeviz-dataSelectionModule-attributeRadio",radioValue:"noAttribute"}));$(e.children().last()).css("font-weight","bold");if(true===_.isUndefined(this.app._.data.selectedComponents.attribute)||true===_.isNull(this.app._.data.selectedComponents.attribute)){$(e.children().first()).attr("checked",true)}d.append(e);h.addList(this.app._.data.components.attributes).sortAscendingBy("__cv_niceLabel").each(function(j){e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogRadioElement").html(),{__cv_niceLabel:j.__cv_niceLabel,__cv_uri:j.__cv_uri,radioCSSClass:"cubeviz-dataSelectionModule-attributeRadio",radioName:"cubeviz-dataSelectionModule-attributeRadio",radioValue:j.__cv_uri}));d.append(e)});this.bindUserInterfaceEvents({"click #cubeviz-attribute-dialogOpener":this.onClick_dialogOpener});$("#cubeviz-attribute-dialogOpener").show()}}else{$("#cubeviz-attribute-dialogOpener").hide()}this.triggerGlobalEvent("onAfterRender_attribute");this.bindUserInterfaceEvents({"click #cubeviz-attributeAndMeasure-questionmark":this.onClick_questionmark});return this};return b})(CubeViz_View_Abstract);var View_DataselectionModule_Component=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_CubeVizModule_Component",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application},{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onChange_selectedSlice",handler:this.onChange_selectedSlice}])}a.prototype.configureSetupComponentDialog=function(d,g,f){var c=this;$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialog").html(),{__cv_niceLabel:d.__cv_niceLabel,__cv_hashedUri:d.__cv_hashedUri,__cv_description:d.__cv_description,__cv_shortDescription:$("#cubeviz-dataSelectionModule-tra-componentDialogDescription").html(),__cv_title:$("#cubeviz-dataSelectionModule-tra-componentDialogMainTitle").html()}));var e=$("#cubeviz-dataSelectionModule-dialog-"+d.__cv_hashedUri);if(true==_.str.isBlank(d.__cv_description)){$(e.find(".cubeviz-dataSelectionModule-dialog-description").get(0)).hide()}e.data("componentBox",g).data("component",d);CubeViz_View_Helper.attachDialogTo(e);$(e.find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).data("dialogDiv",e);$(e.find(".cubeviz-dataSelectionModule-deselectButton").get(0)).data("dialogDiv",e);f.data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-cancelBtn")).get(0)).data("dialogDiv",e);$($(e.find(".cubeviz-dataSelectionModule-closeAndUpdateBtn")).get(0)).data("dialogDiv",e).on("click",$.proxy(this.onClick_closeAndUpdate,this));$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(0)).data("dialogDiv",e).data("type","alphabet");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(1)).data("dialogDiv",e).data("type","check status");$($(e.find(".cubeviz-dataSelectionModule-dialogSortButtons")).children().get(2)).data("dialogDiv",e).data("type","observation count");this.configureSetupComponentElements(d)};a.prototype.configureSetupComponentElements=function(k){var f=null;var j=$("#cubeviz-dataSelectionModule-dialog-"+k.__cv_hashedUri);var i={};var h=new CubeViz_Collection("__cv_uri");var g=$(j.find(".cubeviz-dataSelectionModule-dialogElements")[0]);var e=this.app._.data.selectedComponents.dimensions[k.__cv_uri].__cv_elements;var l=this;var d=null;var c=false;h.addList(k.__cv_elements).sortAscendingBy("__cv_niceLabel").each(function(m){d=undefined!==_.find(e,function(n){return false===_.isUndefined(n)?n.__cv_uri==m.__cv_uri:false});if(true===d){c=true}i=$(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-dialogCheckboxElement").html(),{__cv_niceLabel:m.__cv_niceLabel,__cv_uri:m.__cv_uri,__cv_uri2:m.__cv_uri}));f=i.children().first();if(true==d){f.attr("checked",true)}$(f).on("click",$.proxy(l.onClick_dimensionElementCheckbox,l));i.data("data",m).data("dialogDiv",j);g.append(i)})};a.prototype.destroy=function(){_.each(this.collection._,function(c){$("#cubeviz-dataSelectionModule-dialog-"+c.__cv_hashedUri).dialog("destroy");$("#cubeviz-dataSelectionModule-dialog-"+c.__cv_hashedUri).remove()});b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-component-dialog"));return this};a.prototype.initialize=function(){this.collection.reset("__cv_hashedUri");this.collection.addList(this.app._.data.components.dimensions);this.render()};a.prototype.loadComponentDimensions=function(d){var c=this;DataCube_Component.loadAllDimensions(this.app._.backend.url,this.app._.backend.serviceUrl,this.app._.backend.modelUrl,this.app._.data.selectedDSD.__cv_uri,this.app._.data.selectedDS.__cv_uri,function(e){c.app._.data.components.dimensions=e;c.app._.data.selectedComponents.dimensions=DataCube_Component.getDefaultSelectedDimensions(e);c.collection.reset("__cv_hashedUri").addList(e);d()})};a.prototype.onChange_selectedDS=function(d,e){var c=this;this.destroy();this.loadComponentDimensions(function(){CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.backend.modelUrl,c.app._.data,"data",function(f){c.app._.backend.dataHash=f;c.render();CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.backend.modelUrl,c.app._.data,"data",function(g){DataCube_Observation.loadAll(c.app._.backend.url,c.app._.backend.serviceUrl,c.app._.backend.modelUrl,g,"",function(h){c.app._.data.retrievedObservations=h;CubeViz_View_Helper.hideLeftSidebarSpinner();e.callback()});c.app._.backend.dataHash=g})})})};a.prototype.onChange_selectedSlice=function(g,h){if(0===_.size(this.app._.data.selectedSlice)){}else{var i=null;var f=null;var e="";var c="";var d=this;_.each(this.app._.data.components.dimensions,function(j){e=j["http://purl.org/linked-data/cube#dimension"];c=d.app._.data.selectedSlice[e];if(false===_.str.isBlank(c)){_.each(j.__cv_elements,function(k){if(k.__cv_uri==c){d.app._.data.selectedComponents.dimensions[j.__cv_uri].__cv_elements={0:k}}})}});this.app._.data.numberOfMultipleDimensions=_.size(CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions));this.app._.data.numberOfOneElementDimensions=_.size(CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions));this.destroy().initialize();this.loadComponentDimensions(function(){CubeViz_ConfigurationLink.save(d.app._.backend.url,d.app._.backend.modelUrl,d.app._.data,"data",function(j){d.app._.backend.dataHash=j;d.render();CubeViz_ConfigurationLink.save(d.app._.backend.url,d.app._.backend.modelUrl,d.app._.data,"data",function(k){DataCube_Observation.loadAll(d.app._.backend.url,d.app._.backend.serviceUrl,d.app._.backend.modelUrl,k,"",function(l){d.app._.data.retrievedObservations=l;CubeViz_View_Helper.hideLeftSidebarSpinner();h.callback()});d.app._.backend.dataHash=k})})})}};a.prototype.onClick_cancel=function(c){CubeViz_View_Helper.closeDialog($(c.target).data("dialogDiv"))};a.prototype.onClick_dimensionElementCheckbox=function(e){var f=$(e.target);var h=$($(e.target).parent());var d=h.data("dialogDiv").find('[type="checkbox"]');var c=false;var g=$(h.data("dialogDiv")).data("component").__cv_selectedElementCount;if(1<g||1==this.app._.data.numberOfMultipleDimensions){return}_.each(d,function(i){if($(i).attr("checked")){c=true}});if(false==c){_.each(d,function(i){$(i).attr("disabled",false)});$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).show();$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).show()}else{_.each(d,function(i){if(!$(i).attr("checked")){$(i).attr("disabled",true)}});$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$(h.data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide()}};a.prototype.onClick_closeAndUpdate=function(e){var d=$(e.target).data("dialogDiv");var c=this;CubeViz_View_Helper.showCloseAndUpdateSpinner(d);this.readAndSaveSetupComponentDialogChanges(d,function(){if(true===cubeVizApp._.backend.uiParts.index.isLoaded){c.triggerGlobalEvent("onReRender_visualization")}c.triggerGlobalEvent("onUpdate_componentDimensions");CubeViz_View_Helper.hideCloseAndUpdateSpinner(d);CubeViz_View_Helper.closeDialog(d)})};a.prototype.onClick_deselectButton=function(c){$(c.target).data("dialogDiv").find('[type="checkbox"]').attr("checked",false)};a.prototype.onClick_selectAllButton=function(c){$(c.target).data("dialogDiv").find('[type="checkbox"]').attr("checked",true)};a.prototype.onClick_setupComponentOpener=function(c){this.triggerGlobalEvent("onClick_setupComponentOpener");var e=$($(c.target).data("dialogDiv")).data("component").__cv_selectedElementCount;var d=$(c.target).data("dialogDiv").find('[type="checkbox"]');if(1==e&&2==this.app._.data.numberOfMultipleDimensions&&2<_.size(this.app._.data.components.dimensions)){_.each(d,function(f){if(!$(f).attr("checked")){$(f).attr("disabled",true)}});$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).hide();$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).hide()}else{_.each(d,function(f){$(f).attr("disabled",false)});$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-selectAllButton").get(0)).show();$($(c.target).data("dialogDiv").find(".cubeviz-dataSelectionModule-deselectButton").get(0)).show()}CubeViz_View_Helper.openDialog($(c.target).data("dialogDiv"))};a.prototype.onClick_sortButton=function(e){var d=$(e.target).data("dialogDiv");if(true===_.isUndefined(d)){return}var h=d.data("dimensionTypeUrl");var g=$(d.find(".cubeviz-dataSelectionModule-dialogElements").first());var f=g.children("li");var c=[];$(e.target).data("dialogDiv").find(".cubeviz-component-sortButton").removeClass("cubeviz-dataSelectionModule-dialogSortButtonSelected");$(e.target).addClass("cubeviz-dataSelectionModule-dialogSortButtonSelected");switch($(e.target).data("type")){case"alphabet":c=CubeViz_View_Helper.sortLiItemsByAlphabet(f);break;case"check status":c=CubeViz_View_Helper.sortLiItemsByCheckStatus(f);break;case"observation count":c=CubeViz_View_Helper.sortLiItemsByObservationCount(f,h,this.app._.data.retrievedObservations);break;default:return}g.empty();_.each(c,function(i){g.append(i)})};a.prototype.onClick_questionmark=function(d){$("#cubeviz-dataSelectionModule-dialogContainer").append(CubeViz_View_Helper.tplReplace($("#cubeviz-dataSelectionModule-tpl-helpDialog").html(),{__cv_id:"component",__cv_niceLabel:$("#cubeviz-dataSelectionModule-tra-componentHelpDialogTitle").html(),__cv_description:$("#cubeviz-dataSelectionModule-tra-componentHelpDialogDescription").html()}));var c=$("#cubeviz-dataSelectionModule-helpDialog-component");CubeViz_View_Helper.attachDialogTo(c,{closeOnEscape:true,showCross:true,width:500});CubeViz_View_Helper.openDialog(c)};a.prototype.readAndSaveSetupComponentDialogChanges=function(g,j){var f=g.find(".cubeviz-dataSelectionModule-dialogElements").children();var c=g.data("componentBox");var h=g.data("component");var i=null;var d=null;var e=new CubeViz_Collection("__cv_uri");var k=this;if(undefined===h){return}_.each(f,function(l){i=$($(l).children().get(0));d=$($(l).children().get(1));if("checked"===i.attr("checked")){e.add($(l).data("data"))}});this.app._.data.selectedComponents.dimensions[h.__cv_uri].__cv_elements=e.toObject();$(c.find(".cubeviz-component-selectedCount").get(0)).html(e.size());g.data("component").__cv_selectedElementCount=e.size();this.app._.data.numberOfMultipleDimensions=_.size(CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions));this.app._.data.numberOfOneElementDimensions=_.size(CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions));CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(l){DataCube_Observation.loadAll(k.app._.backend.url,k.app._.backend.serviceUrl,k.app._.backend.modelUrl,l,"",function(m){k.app._.data.retrievedObservations=m;j()});k.app._.backend.dataHash=l})};a.prototype.onComplete_loadDS=function(c,d){this.onChange_selectedDS(c,d)};a.prototype.onComplete_loadObservations=function(d,c){this.app._.data.retrievedObservations=c};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_component");var e=this.collection._;var h=$("#cubviz-component-listBox");var i=null;var c=this.app._.data.selectedComponents.dimensions;var f=null;var d=this;var g=null;this.collection.reset();_.each(e,function(j){if(false===_.isUndefined(c)){f=c[j.__cv_uri];j.__cv_selectedElementCount=_.keys(f.__cv_elements).length}else{j.__cv_selectedElementCount=1}j.__cv_elementCount=_.size(j.__cv_elements);j.__cv_shortLabel=_.str.prune(j.__cv_niceLabel,23,"..");j.__cv_shortDescription=_.str.prune(j.__cv_description,38,"..");i=$(CubeViz_View_Helper.tplReplace($("#cubeviz-component-tpl-listBoxItem").html(),j));if(1===j.__cv_elementCount){$(i.find(".cubeviz-component-setupComponentOpener").get(0)).hide();$(i.find(".cubeviz-component-selectedElementsBlock").get(0)).hide()}$(i.find(".cubeviz-component-setupComponentOpener").get(0)).data("dimension",j);h.append(i);d.configureSetupComponentDialog(j,i,$(i.find(".cubeviz-component-setupComponentOpener").get(0)));$(i.find(".cubeviz-component-selectedCount").get(0)).html(j.__cv_selectedElementCount);d.collection.add(j)});this.bindUserInterfaceEvents({"click .cubeviz-component-setupComponentOpener":this.onClick_setupComponentOpener,"click #cubeviz-component-questionmark":this.onClick_questionmark,"click .cubeviz-dataSelectionModule-cancelBtn":this.onClick_cancel,"click .cubeviz-dataSelectionModule-deselectButton":this.onClick_deselectButton,"click .cubeviz-dataSelectionModule-selectAllButton":this.onClick_selectAllButton,"click .cubeviz-dataSelectionModule-dialogSortButtons":this.onClick_sortButton});this.triggerGlobalEvent("onAfterRender_component");return this};return a})(CubeViz_View_Abstract);var View_DataselectionModule_Footer=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_CubeVizModule_Footer",c,d);this.bindGlobalEvents([{name:"onAfterChange_selectedDSD",handler:this.onAfterChange_selectedDSD},{name:"onBeforeClick_selectorItem",handler:this.onBeforeClick_selectorItem},{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application},{name:"onUpdate_componentDimensions",handler:this.onUpdate_componentDimensions}])}b.prototype.changePermaLinkButton=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){this.collection.add({id:"buttonVal",value:$("#cubeviz-footer-permaLinkButton").html()});this.showLink()}else{this.collection.remove("buttonVal");this.closeLink()}};b.prototype.closeLink=function(){$("#cubeviz-footer-permaLinkMenu").fadeOut("slow")};b.prototype.initialize=function(){this.collection.add({id:"cubeviz-footer-permaLink",html:$("#cubeviz-footer-permaLink").html()});this.render()};b.prototype.onAfterChange_selectedDSD=function(){if(false===_.isUndefined(this.collection.get("buttonVal"))){this.changePermaLinkButton()}};b.prototype.onBeforeClick_selectorItem=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){}else{var c=this.collection.get("buttonVal").value;this.collection.remove("buttonVal");this.closeLink()}};b.prototype.onChange_selectedDS=function(){this.onAfterChange_selectedDSD()};b.prototype.onClick_permaLinkButton=function(c){this.changePermaLinkButton()};b.prototype.onClick_showVisualization=function(d){var c=this;if(true===cubeVizApp._.backend.uiParts.index.isLoaded){CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(e){DataCube_Observation.loadAll(c.app._.backend.url,c.app._.backend.serviceUrl,c.app._.backend.modelUrl,e,"",function(f){c.app._.data.retrievedObservations=f;c.triggerGlobalEvent("onReRender_visualization")});c.app._.backend.dataHash=e})}else{if(false===cubeVizApp._.backend.uiParts.index.isLoaded){CubeViz_ConfigurationLink.save(c.app._.backend.url,c.app._.backend.modelUrl,c.app._.data,"data",function(e){window.location.href=c.app._.backend.url+"?m="+encodeURIComponent(c.app._.backend.modelUrl)+"&cv_dataHash="+e+"&cv_uiHash="+c.app._.backend.uiHash})}else{CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.data,"data",function(e){window.location.href=c.app._.backend.url+"?m="+encodeURIComponent(c.app._.backend.modelUrl)+"&cv_dataHash="+e+"&cv_uiHash="+c.app._.backend.uiHash})}}};b.prototype.onStart_application=function(){this.initialize()};b.prototype.onUpdate_componentDimensions=function(){if(true==_.isUndefined(this.collection.get("buttonVal"))){}else{var c=this.collection.get("buttonVal").value;this.collection.remove("buttonVal");this.closeLink()}};b.prototype.render=function(){this.bindUserInterfaceEvents({"click #cubeviz-footer-permaLinkButton":this.onClick_permaLinkButton,"click #cubeviz-footer-showVisualizationButton":this.onClick_showVisualization});return this};b.prototype.showLink=function(){var e=this.app._.backend.url+"?";if(false==_.str.isBlank(this.app._.backend.serviceUrl)){e+="serviceUrl="+encodeURIComponent(this.app._.backend.serviceUrl)+"&"}e+="m="+encodeURIComponent(this.app._.backend.modelUrl)+"&cv_dataHash="+this.app._.backend.dataHash+"&cv_uiHash="+this.app._.backend.uiHash;var c=$("<a></a>").attr("href",e).attr("target","_self").html(this.collection.get("cubeviz-footer-permaLink").html);$("#cubeviz-footer-permaLink").html(c);var d=$("#cubeviz-footer-permaLinkButton").position();$("#cubeviz-footer-permaLinkMenu").css("top",(d.top+30)).css("left",(d.left)).fadeIn("slow")};return b})(CubeViz_View_Abstract);var View_IndexAction_ExportArea=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_IndexAction_ExportArea",c,d);this.bindGlobalEvents([{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application},{name:"onUpdate_componentDimensions",handler:this.onUpdate_componentDimensions}])}b.prototype.destroy=function(){a.prototype.destroy.call(this);return this};b.prototype.initialize=function(){this.render()};b.prototype.onReRender_visualization=function(){this.initialize()};b.prototype.onStart_application=function(){this.initialize()};b.prototype.onUpdate_componentDimensions=function(){this.initialize()};b.prototype.render=function(){this.setUrlToDownload();return this};b.prototype.setUrlToDownload=function(){var c=this.app._.backend.url+"exportdataselection/?serviceUrl="+encodeURIComponent(this.app._.backend.serviceUrl)+"&dataHash="+this.app._.backend.dataHash;$("#cubeviz-index-exportArea-btnTurtle").attr("href",c+"&type=turtle");$("#cubeviz-index-exportArea-btnCsv").attr("href",c+"&type=csv")};return b})(CubeViz_View_Abstract);var View_IndexAction_Header=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_Header",c,d);this.bindGlobalEvents([{name:"onChange_selectedDS",handler:this.onChange_selectedDS},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);CubeViz_View_Helper.destroyDialog($("#cubeviz-index-headerDialogBox"));return this};a.prototype.initialize=function(){this.render()};a.prototype.onChange_selectedDS=function(){if(false===this.app._.backend.uiSettings.useDataSetInsteadOfModel){$("#cubeviz-index-headerSubheadline").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel}))}else{$("#cubeviz-index-header").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel}))}};a.prototype.onClick_questionMark=function(){$("#cubeviz-index-headerDialogBox").dialog("open")};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){CubeViz_View_Helper.attachDialogTo($("#cubeviz-index-headerDialogBox"),{closeOnEscape:true,height:450,showCross:true,width:"50%"});this.renderHeader();this.renderDialogBox();this.bindUserInterfaceEvents({"click #cubeviz-index-headerQuestionMarkHeadline":this.onClick_questionMark});return this};a.prototype.renderDialogBox=function(){var d="";if(false===_.isUndefined(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])&&false===_.str.isBlank(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])){d=this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"].content}else{d=this.app._.backend.modelUrl}$("#cubeviz-index-headerDialogBox").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerDialogBoxHead").html(),{label:d}));var c=$($("#cubeviz-index-headerDialogBox").children().last());_.each(this.app._.backend.modelInformation,function(e){c.append(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerDialogBoxEntry").html(),{predicateLabel:e.predicateLabel,objectContent:CubeViz_Visualization_Controller.linkify(e.content)}))})};a.prototype.renderHeader=function(){var c;if(false===_.isUndefined(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])&&false===_.str.isBlank(this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"])){c=this.app._.backend.modelInformation["http://www.w3.org/2000/01/rdf-schema#label"].content}else{c=this.app._.backend.modelUrl}if(false===this.app._.backend.uiSettings.useDataSetInsteadOfModel){$("#cubeviz-index-header").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-header").html(),{modelLabel:c}));$("#cubeviz-index-headerSubheadline").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel})+$("#cubeviz-index-tpl-headerSubheadlineButtons").html())}else{$("#cubeviz-index-header").html(CubeViz_View_Helper.tplReplace($("#cubeviz-index-tpl-headerSubheadline").html(),{selectedDataSet:this.app._.data.selectedDS.__cv_niceLabel}));$("#cubeviz-index-headerSubheadline").html($("#cubeviz-index-tpl-headerSubheadlineButtons").html())}};return a})(CubeViz_View_Abstract);var View_IndexAction_Legend=(function(a){__extends(b,a);function b(c,d){a.call(this,"View_IndexAction_Legend",c,d);this.bindGlobalEvents([{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application}])}b.prototype.destroy=function(){$("#cubeviz-legend-btnShowRetrievedObservations").off();$("#cubeviz-legend-sortByTitle").off();$("#cubeviz-legend-sortByValue").off();$("#cubeviz-legend-retrievedObservations").slideUp("slow");$("#cubeviz-legend-selectedConfiguration").slideUp("slow");$("#cubeviz-legend-dataSet").html("");$("#cubeviz-legend-observations").html("");$("#cubeviz-legend-configurationList").html("");CubeViz_View_Helper.destroyDialog($("#cubeviz-legend-componentDimensionInfoDialog"));a.prototype.destroy.call(this);return this};b.prototype.displayDataset=function(f,e){var c=this;var d=null;$("#cubeviz-legend-dsLabel").html('<a href="'+f.__cv_uri+'" target="_blank">'+f.__cv_niceLabel+"</a>");$("#cubeviz-legend-dsProperties").html('<tr class="info"><td><strong>Property</strong></td><td><strong>Value</strong></td></tr>');$("#cubeviz-legend-dsProperties").append('<tr><td>URI</td><td style="word-break:break-all;"><a href="'+f.__cv_uri+'" target="_blank">'+f.__cv_uri+"</a></td></tr>");_.each(f,function(i,h){if(false===_.str.include(h,"__cv_")){if("http://purl.org/linked-data/cube#structure"==h){i='<a href="'+e.__cv_uri+'" target="_blank">'+e.__cv_niceLabel+"</a>"}else{if(true===_.isObject(i)||true===_.isArray(i)){var g=new CubeViz_Collection();i=CubeViz_Visualization_Controller.linkify(g.addList(i)._.join(", "))}else{if(true===c.isValidUrl(i)){i='<a href="'+i+'" target="_blank">'+_.str.prune(i,60)+"</a>"}}}$("#cubeviz-legend-dsProperties").append('<tr><td><a href="'+h+'" target="_blank">'+h+'</a></td><td style="word-break:break-all;">'+i+"</td></tr>")}});if(false===_.isNull(f.__cv_sourceDataset)&&false===_.isUndefined(f.__cv_sourceDataset)){_.each(f.__cv_sourceDataset,function(g){$("#cubeviz-legend-dsProperties").append('<tr><td colspan="2"><a name="'+(CryptoJS.MD5(g.__cv_uri)+"").substring(0,6)+'"></a></td></tr><tr class="warning"><td colspan="2"><strong>Source Dataset: <a href="'+g.__cv_uri+'" target="_blank">'+g.__cv_niceLabel+"</a></strong></td></tr>");$("#cubeviz-legend-dsProperties").append('<tr><td>URI</td><td style="word-break:break-all;"><a href="'+g.__cv_uri+'" target="_blank">'+g.__cv_uri+"</a></td></tr>");_.each(g,function(j,i){if(false===_.str.include(i,"__cv_")){if(true===_.isObject(j)||true===_.isArray(j)){var h=new CubeViz_Collection();j=CubeViz_Visualization_Controller.linkify(h.addList(j)._.join(", "))}else{if(true===c.isValidUrl(j)){j='<a href="'+j+'" target="_blank">'+_.str.prune(j,60)+"</a>"}}$("#cubeviz-legend-dsProperties").append('<tr><td><a href="'+i+'" target="_blank">'+i+"</a></td><td>"+j+"</td></tr>")}})})}};b.prototype.displayDataStructureDefinition=function(e){var c=this;var d=null;$("#cubeviz-legend-dsdLabel").html('<a href="'+e.__cv_uri+'" target="_blank">'+e.__cv_niceLabel+"</a>");$("#cubeviz-legend-dsdProperties").html('<tr class="info"><td><strong>Property</strong></td><td><strong>Value</strong></td></tr>');$("#cubeviz-legend-dsdProperties").append('<tr><td>URI</td><td style="word-break:break-all;"><a href="'+e.__cv_uri+'" target="_blank">'+e.__cv_uri+"</a></td></tr>");_.each(e,function(h,g){if(false===_.str.include(g,"__cv_")){if("http://purl.org/linked-data/cube#component"==g){var i=[];var f=new CubeViz_Collection();f.addList(h).each(function(j){_.each(c.app._.data.selectedComponents.dimensions,function(k){if(j===k.__cv_uri){i.push('<a href="#'+(CryptoJS.MD5(k.__cv_uri)+"").substring(0,6)+'">'+k.__cv_niceLabel+'</a> <i class="icon-anchor" style="font-size: 10px;"></i>')}})});i.push(c.app._.data.selectedComponents.measure.__cv_niceLabel);if(false===_.isNull(c.app._.data.selectedComponents.attribute)&&false===_.isUndefined(c.app._.data.selectedComponents.attribute)){i.push(c.app._.data.selectedComponents.attribute.__cv_niceLabel)}h=i.join(", ")}else{if(true===_.isObject(h)||true===_.isArray(h)){var f=new CubeViz_Collection();h=CubeViz_Visualization_Controller.linkify(f.addList(h)._.join(", "))}else{if(true===c.isValidUrl(h)){h='<a href="'+h+'" target="_blank">'+_.str.prune(h,60)+"</a>"}}}$("#cubeviz-legend-dsdProperties").append('<tr><td><a href="'+g+'" target="_blank">'+g+'</a></td><td style="word-break:break-all;">'+h+"</td></tr>")}})};b.prototype.displayRetrievedObservations=function(d,g,f){var k="";var h=0;var m="";var n=this;$("#cubeviz-legend-retrievedObservationsTitle").html(_.size(d)+" Retrieved Observations");$("#cubeviz-legend-observations").html("");k="<tr><td></td>";_.each(g,function(i){k+="<td>"+CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-observationsTableHeadEntry").html(),i)+"</td>"});k+='<td colspan="2">'+CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-observationsTableHeadEntry").html(),f)+"</td>";k+="<td></td></tr>";$("#cubeviz-legend-observations").append(k);_.each(g,function(i){$($("#cubeviz-legend-observations").find(".cubeviz-legend-sortAsc").get(h)).data("dimension",i);$($("#cubeviz-legend-observations").find(".cubeviz-legend-sortDesc").get(h++)).data("dimension",i)});$($("#cubeviz-legend-observations").find(".cubeviz-legend-sortAsc").get(h)).data("measure",f);$($("#cubeviz-legend-observations").find(".cubeviz-legend-sortDesc").get(h)).data("measure",f);var e=DataCube_Observation.getValues(d,f["http://purl.org/linked-data/cube#measure"]);var l=0;var c="<strong>min:</strong> "+String(jsStats.min(e[0])).substring(0,10);var j="<strong>max:</strong> "+String(jsStats.max(e[0])).substring(0,10);k='<tr class="info"><td></td>';_.each(g,function(i){l=_.size(DataCube_Observation.getUsedDimensionElementUris(d,i["http://purl.org/linked-data/cube#dimension"]));if(l<_.size(i.__cv_elements)){k+="<td><strong>"+_.size(i.__cv_elements)+"</strong> different dimension elements available, but only <strong>"+l+"</strong> are in use</td>"}else{k+="<td><strong>"+_.size(i.__cv_elements)+"</strong> different dimension elements are in use</td>"}});k+="<td>"+c+"</td><td>"+j+"</td><td></td>";"</tr>";$("#cubeviz-legend-observations").append(k);var h=0;_.each(d,function(o){k='<tr><td rowspan="2"><strong>'+h+++"</strong></td>";_.each(g,function(p){_.each(p.__cv_elements,function(q){if(q.__cv_uri==o[p["http://purl.org/linked-data/cube#dimension"]]){m=q.__cv_niceLabel}});k+='<td class="cubeviz-legend-dimensionElementLabelTd"><i class="icon-anchor" style="font-size: 8px;"></i> <a href="#'+(CryptoJS.MD5(p.__cv_uri)+"").substring(0,6)+'" title="Anchor to dimension: '+p.__cv_niceLabel+'">'+m+"</a>";k+="</td>"});k+='<td class="cubeviz-legend-measureTd" colspan="2">'+o[f["http://purl.org/linked-data/cube#measure"]]+"</td>";k+='<td><a href="'+o.__cv_uri+'" target="_blank">Link</a></td>';k+="</tr>";if(false===_.isNull(o.__cv_sourceDataset)&&false===_.isUndefined(o.__cv_sourceDataset)){k+='<tr><td colspan="'+(3+_.size(g))+'" style="padding-top: 2px; padding-bottom: 10px;"><small>Source Dataset: <strong><a href="#'+(CryptoJS.MD5(o.__cv_sourceDataset.__cv_uri)+"").substring(0,6)+'">'+o.__cv_sourceDataset.__cv_niceLabel+'</a></strong></small><br/><small><div class="cubeviz-clickable cubeviz-legend-sourceObservationOpener">Show more information about source Observation <i class="icon-chevron-down"></i></div></small><br/><table class="cubeviz-legend-sourceObservation table table-bordered table-condensed table-striped responsive-utilities"></table></td></tr>'}$("#cubeviz-legend-observations > tbody:last").append(k);$($("#cubeviz-legend-observations").find(".cubeviz-legend-measureTd").last()).data("observation",o);if(false===_.isNull(o.__cv_sourceObservation)&&false===_.isUndefined(o.__cv_sourceObservation)){var i=$($("#cubeviz-legend-observations").find(".cubeviz-legend-sourceObservation").last());i.append('<tr><td>URI</td><td style="word-break:break-all;"><a href="'+o.__cv_sourceObservation.__cv_uri+'" target="_blank">'+o.__cv_sourceObservation.__cv_uri+"</a></td></tr>");_.each(o.__cv_sourceObservation,function(r,q){if(false===_.str.include(q,"__cv_")){if(true===_.isObject(r)||true===_.isArray(r)){var p=new CubeViz_Collection();r=CubeViz_Visualization_Controller.linkify(p.addList(r)._.join(", "))}else{if(true===n.isValidUrl(r)){r='<a href="'+r+'" target="_blank">'+_.str.prune(r,60)+"</a>"}}i.append('<tr><td><a href="'+q+'" target="_blank">'+q+'</a></td><td style="word-break:break-all;">'+r+"</td></tr>")}});i.hide();$($("#cubeviz-legend-observations").find(".cubeviz-legend-sourceObservationOpener").last()).click(function(){i.fadeToggle(200)})}});this.bindUserInterfaceEvents({"dblclick .cubeviz-legend-measureTd":this.onDblClick_measureTd,"click .cubeviz-legend-sortAsc":this.onClick_sortAsc,"click .cubeviz-legend-sortDesc":this.onClick_sortDesc})};b.prototype.displaySelectedDimensions=function(c){var f=new CubeViz_Collection();var d=this;var g=new CubeViz_Collection();var e=null;$("#cubeviz-legend-componentDimensions").html("");_.each(c,function(h){$("#cubeviz-legend-componentDimensions").append($(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-dimensionBlock").html(),{dimensionLabel:h.__cv_niceLabel,dimensionUri:h.__cv_uri,dimensionUriHash:(CryptoJS.MD5(h.__cv_uri)+"").substring(0,6)})));e=$($("#cubeviz-legend-componentDimensions").find(".table").last());e.append('<tr class="info"><td><strong>Property</strong></td><td><strong>Value</strong></td></tr>');e.append('<tr><td>URI</td><td style="word-break:break-all;"><a href="'+h.__cv_uri+'" target="_blank">'+h.__cv_uri+"</a></td></tr>");_.each(h,function(k,j){if(false===_.str.include(j,"__cv_")){if(true===_.isObject(k)||true===_.isArray(k)){var i=new CubeViz_Collection();k=CubeViz_Visualization_Controller.linkify(i.addList(k)._.join(", "))}else{if(true==d.isValidUrl(k)){k='<a href="'+k+'" target="_blank">'+_.str.prune(k,60)+"</a>"}}e.append('<tr><td><a href="'+j+'">'+j+"</a></td><td>"+k+"</td></tr>")}});g.reset();f.reset().addList(h.__cv_elements).each(function(i){e.append(g.add('<a href="'+i.__cv_uri+'" target="_blank">'+i.__cv_niceLabel+"</a>",null,true))});e.append('<tr><td colspan="2"><strong><em>Dimension Elements</em></strong></td></tr><tr><td colspan="2">'+g._.join(", ")+"</td></tr>");if(false===_.isNull(h.__cv_sourceComponentSpecification)&&false===_.isUndefined(h.__cv_sourceComponentSpecification)){_.each(h.__cv_sourceComponentSpecification,function(i){e.append('<tr><td colspan="2"></td></tr><tr class="warning"><td colspan="2"><strong>Source Component Specification: <a href="'+i.__cv_uri+'" target="_blank">'+i.__cv_niceLabel+"</a></strong></td></tr>");e.append('<tr><td>URI</td><td style="word-break:break-all;"><a href="'+i.__cv_uri+'" target="_blank">'+i.__cv_uri+"</a></td></tr>");_.each(i,function(l,k){if(false===_.str.include(k,"__cv_")){if(true===_.isObject(l)||true===_.isArray(l)){var j=new CubeViz_Collection();l=CubeViz_Visualization_Controller.linkify(j.addList(l)._.join(", "))}else{if(true===d.isValidUrl(l)){l='<a href="'+l+'" target="_blank">'+_.str.prune(l,60)+"</a>"}}e.append('<tr><td><a href="'+k+'" target="_blank">'+k+'</a></td><td style="word-break:break-all;">'+l+"</td></tr>")}});g.reset();f.reset().addList(i.__cv_elements).each(function(j){e.append(g.add('<a href="'+j.__cv_uri+'" target="_blank">'+j.__cv_niceLabel+"</a>",null,true))});e.append('<tr><td colspan="2"><em>Dimension Elements</em></td></tr><tr><td colspan="2">'+g._.join(", ")+"</td></tr>")})}})};b.prototype.displaySelectedMeasureAndAttribute=function(d,c){var e=this;var f=$("#cubeviz-legend-componentMeasureProperties");$("#cubeviz-legend-componentMeasureLabel").html('<a href="'+d.__cv_uri+'">'+d.__cv_niceLabel+"</a>");f.append('<tr class="info"><td><strong>Property</strong></td><td><strong>Value</strong></td></tr>');_.each(d,function(i,h){if(false===_.str.include(h,"__cv_")){if(true===_.isObject(i)||true===_.isArray(i)){var g=new CubeViz_Collection();i=CubeViz_Visualization_Controller.linkify(g.addList(i)._.join(", "))}else{if(true==e.isValidUrl(i)){i='<a href="'+i+'" target="_blank">'+_.str.prune(i,60)+"</a>"}}f.append('<tr><td><a href="'+h+'">'+h+"</a></td><td>"+i+"</td></tr>")}});if(false===_.isNull(d.__cv_sourceMeasure)&&false===_.isUndefined(d.__cv_sourceMeasure)){_.each(d.__cv_sourceMeasure,function(g){f.append('<tr><td colspan="2"></td></tr><tr class="warning"><td colspan="2"><strong>Source Measure: <a href="'+g.__cv_uri+'" target="_blank">'+g.__cv_niceLabel+"</a></strong></td></tr>");f.append('<tr><td>URI</td><td style="word-break:break-all;"><a href="'+g.__cv_uri+'" target="_blank">'+g.__cv_uri+"</a></td></tr>");_.each(g,function(j,i){if(false===_.str.include(i,"__cv_")){if(true===_.isObject(j)||true===_.isArray(j)){var h=new CubeViz_Collection();j=CubeViz_Visualization_Controller.linkify(h.addList(j)._.join(", "))}else{if(true===e.isValidUrl(j)){j='<a href="'+j+'" target="_blank">'+_.str.prune(j,60)+"</a>"}}f.append('<tr><td><a href="'+i+'" target="_blank">'+i+'</a></td><td style="word-break:break-all;">'+j+"</td></tr>")}})})}if(true===_.isNull(c)||true===_.isUndefined(c)){$("#cubeviz-legend-componentAttribute").hide()}else{$("#cubeviz-legend-componentAttributeLabel").html('<a href="'+d.__cv_uri+'">'+c.__cv_niceLabel+"</a>");$("#cubeviz-legend-componentAttributeProperties").append('<tr class="info"><td><strong>Property</strong></td><td><strong>Value</strong></td></tr>');_.each(c,function(i,h){if(false===_.str.include(h,"__cv_")){if(true===_.isObject(i)||true===_.isArray(i)){var g=new CubeViz_Collection();i=CubeViz_Visualization_Controller.linkify(g.addList(i)._.join(", "))}else{if(true==e.isValidUrl(i)){i='<a href="'+i+'" target="_blank">'+_.str.prune(i,60)+"</a>"}}$("#cubeviz-legend-componentAttributeProperties").append('<tr><td><a href="'+h+'">'+h+"</a></td><td>"+i+"</td></tr>")}})}};b.prototype.initialize=function(){this.render()};b.prototype.isValidUrl=function(c){return((new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)*[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i")).test(c))&&(true===_.str.include(c,".")||true===_.str.include(c,"/"))};b.prototype.onClick_adaptedMeasureValueSaveBtn=function(i){var g=$(i.target).data("observation");var f=this;var c=$(i.target).data("inputField");var d=$(i.target).data("measureTd");var h=$(i.target);g.__cv_temporaryNewValue=c.val();_.each(this.app._.data.retrievedObservations,function(e,j){if(e.__cv_uri===g.__cv_uri){f.app._.data.retrievedObservations[j]=g}});this.restoreMeasureTd(d);this.triggerGlobalEvent("onReRender_visualization")};b.prototype.onClick_btnShowRetrievedObservations=function(c){c.preventDefault();$("#cubeviz-legend-retrievedObservations").slideToggle("slow");return false};b.prototype.onClick_btnShowSelectedConfiguration=function(c){c.preventDefault();$("#cubeviz-legend-selectedConfiguration").slideToggle("slow");return false};b.prototype.onClick_componentDimensionShowInfo=function(f){f.preventDefault();var e=$(f.target);var h=e.data("dimension");var g=e.data("dimensionElement");var c=e.data("observationIcon");var d=$($("#cubeviz-legend-tpl-componentDimensionInfoList").html());_.each(g,function(j,i){if(false===_.str.startsWith(i,"__cv_")){d.append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionInfoListEntry").html(),{key:i,value:CubeViz_Visualization_Controller.linkify(j)}))}});$("#cubeviz-legend-componentDimensionInfoDialog").html("").append(CubeViz_View_Helper.tplReplace($("#cubeviz-legend-tpl-componentDimensionInfoHeader").html(),g)).append(d).fadeIn("slow");$("#cubeviz-legend-componentDimensionInfoDialog").dialog("open");return false};b.prototype.onClick_sortAsc=function(c){if(false===_.isUndefined($(c.target).data("dimension"))){this.app._.data.retrievedObservations=this.sortDimensionsAscOrDesc($(c.target).data("dimension"),this.app._.data.retrievedObservations,-1,1)}else{if(false===_.isUndefined($(c.target).data("measure"))){this.app._.data.retrievedObservations=this.sortMeasureValuesAscOrDesc($(c.target).data("measure"),this.app._.data.retrievedObservations,-1,1)}else{return}}this.displayRetrievedObservations(this.app._.data.retrievedObservations,this.app._.data.selectedComponents.dimensions,this.app._.data.selectedComponents.measure)};b.prototype.onClick_sortDesc=function(c){if(false===_.isUndefined($(c.target).data("dimension"))){this.app._.data.retrievedObservations=this.sortDimensionsAscOrDesc($(c.target).data("dimension"),this.app._.data.retrievedObservations,1,-1)}else{if(false===_.isUndefined($(c.target).data("measure"))){this.app._.data.retrievedObservations=this.sortMeasureValuesAscOrDesc($(c.target).data("measure"),this.app._.data.retrievedObservations,1,-1)}else{return}}this.displayRetrievedObservations(this.app._.data.retrievedObservations,this.app._.data.selectedComponents.dimensions,this.app._.data.selectedComponents.measure)};b.prototype.onDblClick_measureTd=function(i){if(true===_.isUndefined($(i.target).data("observation"))||true===_.isNull($(i.target).data("observation"))){return}var f=$(i.target).data("observation");var d=null;var h=this.app._.data.selectedComponents.measure["http://purl.org/linked-data/cube#measure"];if(false===_.isUndefined(f.__cv_temporaryNewValue)){d=f.__cv_temporaryNewValue}else{d=f[h]}var c=$('<input type="text" value="'+d+'">');var g=$('<div class="btn btn-primary" style="vertical-align: top;">Save</div>');$(i.target).html("").append(c).append(g);g.data("inputField",c).data("measureTd",$(i.target)).data("observation",f).on("click",$.proxy(this.onClick_adaptedMeasureValueSaveBtn,this));c.focus()};b.prototype.onReRender_visualization=function(){};b.prototype.onStart_application=function(){this.initialize()};b.prototype.render=function(){var d=this.app._.data.selectedComponents.measure["http://purl.org/linked-data/cube#measure"];var c=this;this.displayDataStructureDefinition(this.app._.data.selectedDSD);this.displayDataset(this.app._.data.selectedDS,this.app._.data.selectedDSD);this.displaySelectedDimensions(this.app._.data.selectedComponents.dimensions);this.displaySelectedMeasureAndAttribute(this.app._.data.selectedComponents.measure,this.app._.data.selectedComponents.attribute);this.collection.reset("__cv_niceLabel").addList(this.app._.data.retrievedObservations);this.collection.sortAscendingBy(d);this.displayRetrievedObservations(this.collection._,this.app._.data.selectedComponents.dimensions,this.app._.data.selectedComponents.measure);CubeViz_View_Helper.attachDialogTo($("#cubeviz-legend-componentDimensionInfoDialog"),{closeOnEscape:true,showCross:true,height:450,width:"50%"});$("#cubeviz-legend-btnShowRetrievedObservations").off();$("#cubeviz-legend-btnShowSelectedConfiguration").off();$(".cubeviz-legend-componentDimensionShowInfo").off();$("#cubeviz-legend-sortByTitle").off();$("#cubeviz-legend-sortByValue").off();this.bindUserInterfaceEvents({"click #cubeviz-legend-btnShowSelectedConfiguration":this.onClick_btnShowSelectedConfiguration,"click #cubeviz-legend-btnShowRetrievedObservations":this.onClick_btnShowRetrievedObservations,"click .cubeviz-legend-componentDimensionShowInfo":this.onClick_componentDimensionShowInfo});return this};b.prototype.restoreMeasureTd=function(d){var c=d.data("observation");var e=this.app._.data.selectedComponents.measure["http://purl.org/linked-data/cube#measure"];d.html(c.__cv_temporaryNewValue+" &nbsp; <small>(Original: "+c[e]+")")};b.prototype.sortDimensionsAscOrDesc=function(i,j,g,f){var h="";var e="";var d=new CubeViz_Collection("__cv_uri");var c=i["http://purl.org/linked-data/cube#dimension"];d.addList(j);d._.sort(function(k,l){h=DataCube_Component.findDimensionElement(i.__cv_elements,k[c]).__cv_niceLabel;e=DataCube_Component.findDimensionElement(i.__cv_elements,l[c]).__cv_niceLabel;return h<e?g:f});return d.toObject()};b.prototype.sortMeasureValuesAscOrDesc=function(g,h,f,e){var d=new CubeViz_Collection("__cv_uri");var c=g["http://purl.org/linked-data/cube#measure"];d.addList(h);d._.sort(function(i,j){return i[c]<j[c]?f:e});return d.toObject()};return b})(CubeViz_View_Abstract);var View_IndexAction_Visualization=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_Visualization",c,d);this.bindGlobalEvents([{name:"onChange_visualizationClass",handler:this.onChange_visualizationClass},{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);return this};a.prototype.handleException=function(c){this.setVisualizationHeight();if(true===_.str.include(c,"Highcharts error #10")){$("#cubeviz-index-visualization").html($("#cubeviz-visualization-tpl-notificationHightchartsException10").html())}else{if(true===_.str.include(c,"CubeViz error no observations retrieved")){$("#cubeviz-index-visualization").html($("#cubeviz-visualization-tpl-nothingFoundNotification").text());this.triggerGlobalEvent("onReceived_noData")}else{if(true===_.str.include(c,"CubeViz error no elements to visualize")){$("#cubeviz-index-visualization").html("CubeViz error no elements to visualize");this.triggerGlobalEvent("onVisualize_noElements")}}}if(false===_.isUndefined(console)&&false===_.isUndefined(console.log)){console.log(c)}};a.prototype.initialize=function(){this.render()};a.prototype.onChange_visualizationClass=function(){this.render()};a.prototype.onClick_nothingFoundNotificationLink=function(c){$("#cubeviz-visualization-nothingFoundFurtherExplanation").slideDown("slow")};a.prototype.onReRender_visualization=function(){this.render()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){if(0==_.size(this.app._.data.retrievedObservations)){this.handleException("CubeViz error no observations retrieved");return this}var c=null;if((false===_.isNull(this.app._.data.selectedComponents.attribute)&&false===_.isUndefined(this.app._.data.selectedComponents.attribute))){if(false===this.app._.data.selectedComponents.attribute.__cv_inUse){}else{c=this.app._.data.selectedComponents.attribute["http://purl.org/linked-data/cube#attribute"]}}var h=null;var d=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var j=null;var f=this.app._.data.selectedComponents.measure;var i=null;var k=null;if(true===_.isNull(d)){var e=CubeViz_Visualization_Controller.getDefaultChartConfig(this.app._.backend.chartConfig,this.app._.data.numberOfMultipleDimensions);this.app._.ui.visualization.className=e.className;d=e.chartConfig}k=CubeViz_Visualization_Controller.updateVisualizationSettings([],this.app._.ui.visualizationSettings[this.app._.ui.visualization.className],d.defaultConfig);i=CubeViz_Visualization_Controller.getVisualizationType(this.app._.ui.visualization.className);switch(i){case"HighCharts":if(false===_.isUndefined(this.app._.generatedVisualization)){try{this.app._.generatedVisualization.destroy()}catch(g){if(false===_.isUndefined(console)&&false===_.isUndefined(console.log)){console.log(g)}}}j=new CubeViz_Visualization_HighCharts();h=j.load(this.app._.ui.visualization.className);break;case"D3js":this.app._.generatedVisualization=null;$("#cubeviz-index-visualization").html("");j=new CubeViz_Visualization_D3js();h=j.load(this.app._.ui.visualization.className);break;default:break}h.init(k,this.app._.data.retrievedObservations,this.app._.data.selectedComponents.dimensions,CubeViz_Visualization_Controller.getMultipleDimensions(this.app._.data.selectedComponents.dimensions),CubeViz_Visualization_Controller.getOneElementDimensions(this.app._.data.selectedComponents.dimensions),f,c);try{switch(i){case"HighCharts":this.setVisualizationHeight(_.size(h.getRenderResult().xAxis.categories));if(0==_.size(h.getRenderResult().series)){this.handleException("CubeViz error no elements to visualize");return this}break}this.app._.generatedVisualization=j.render(h)}catch(g){this.handleException(g)}return this};a.prototype.setVisualizationHeight=function(c){if(typeof c==="undefined"){c=0}var f=$(this.attachedTo).offset();var e=$(window).height()-f.top-105;var d=0;if(0<c){d=c*40;if(d>e){e=d}}$(this.attachedTo).css("height",e)};return a})(CubeViz_View_Abstract);var View_IndexAction_VisualizationSelector=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_IndexAction_VisualizationSelector",c,d);this.bindGlobalEvents([{name:"onClick_setupComponentOpener",handler:this.onClick_setupComponentOpener},{name:"onReceived_noData",handler:this.onReceived_noData},{name:"onReRender_visualization",handler:this.onReRender_visualization},{name:"onStart_application",handler:this.onStart_application},{name:"onVisualize_noElements",handler:this.onVisualize_noElements}])}a.prototype.destroy=function(){b.prototype.destroy.call(this);$("#cubeviz-visualizationselector-selector").empty();this.hideDongle();this.hideMenu();return this};a.prototype.hideDongle=function(){$("#cubeviz-visualizationselector-menuDongleDiv").fadeOut("slow");return this};a.prototype.hideMenu=function(){this.triggerGlobalEvent("onBeforeHide_visualizationSelectorMenu");$("#cubeviz-visualizationselector-menu").fadeOut("slow");$("#cubeviz-visualizationselector-menuItems").html("");this.triggerGlobalEvent("onAfterHide_visualizationSelectorMenu");return this};a.prototype.initialize=function(){this.render()};a.prototype.onClick_setupComponentOpener=function(){this.hideMenu()};a.prototype.onClick_closeMenu=function(){this.hideMenu()};a.prototype.onClick_selectorItem=function(e){this.triggerGlobalEvent("onBeforeClick_selectorItem");var f="";var c=null;var d=this;if(true===_.isUndefined($(e.target).data("class"))){c=$($(e.target).parent());this.app._.ui.visualization.className=c.data("class")}else{c=$(e.target);this.app._.ui.visualization.className=c.data("class")}f=$($(".cubeviz-visualizationselector-selectedSelectorItem").get(0)).data("class");this.hideDongle();if(f==this.app._.ui.visualization.className){this.showMenu(c)}else{this.hideMenu();$(".cubeviz-visualizationselector-selectedSelectorItem").removeClass("cubeviz-visualizationselector-selectedSelectorItem").addClass("cubeviz-visualizationselector-selectorItem");c.removeClass("cubeviz-visualizationselector-selectorItem").addClass("cubeviz-visualizationselector-selectedSelectorItem");this.showMenuDongle(c);this.triggerGlobalEvent("onChange_visualizationClass");CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.ui,"ui",function(g){d.app._.backend.uiHash=g})}this.triggerGlobalEvent("onAfterClick_selectorItem")};a.prototype.onClick_updateVisz=function(){var d=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c=this;this.app._.ui.visualizationSettings[this.app._.ui.visualization.className]=CubeViz_Visualization_Controller.updateVisualizationSettings($(".cubeviz-visualizationselector-menuItemValue"),this.app._.ui.visualizationSettings[this.app._.ui.visualization.className],d.defaultConfig);CubeViz_ConfigurationLink.save(this.app._.backend.url,this.app._.backend.modelUrl,this.app._.ui,"ui",function(e){c.app._.backend.uiHash=e});this.triggerGlobalEvent("onReRender_visualization")};a.prototype.onReceived_noData=function(){this.hideDongle()};a.prototype.onReRender_visualization=function(){this.destroy();if(0<_.size(this.app._.data.retrievedObservations)){this.initialize()}};a.prototype.onStart_application=function(){if(0<_.size(this.app._.data.retrievedObservations)){this.initialize()}};a.prototype.onVisualize_noElements=function(){this.hideDongle().hideMenu()};a.prototype.render=function(){this.triggerGlobalEvent("onBeforeRender_visualizationSelector");var g=this.app._.data.numberOfMultipleDimensions;var f=this.app._.backend.chartConfig[g].charts;var c;var d=this;var e;this.hideDongle();_.each(f,function(h){e=$(CubeViz_View_Helper.tplReplace($("#cubeviz-visualizationselector-tpl-selectorItem").html()));$(e.find(".cubeviz-icon-small").first()).attr("src",d.app._.backend.imagesPath+h.icon);e.data("class",h.className);e.off("click");e.on("click",$.proxy(d.onClick_selectorItem,d));if(d.app._.ui.visualization.className==h.className){e.addClass("cubeviz-visualizationselector-selectedSelectorItem").removeClass("cubeviz-visualizationselector-selectorItem")}$("#cubeviz-visualizationselector-selector").append(e)});this.showMenuDongle($($("#cubeviz-visualizationselector-selector").find(".cubeviz-visualizationselector-selectedSelectorItem").first()));this.bindUserInterfaceEvents({});this.triggerGlobalEvent("onAfterRender_visualizationSelector");return this};a.prototype.showMenu=function(f){this.triggerGlobalEvent("onBeforeShow_visualizationSelectorMenu");var k=false;var i="";var e=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts);var c;var j=$("#cubeviz-visualizationselector-menuItems").html();var g=f.position();var l;var h=this.app._.ui.visualizationSettings[this.app._.ui.visualization.className];var d;if(false===_.isUndefined(e.options)&&0<_.size(e.options)&&(""==j||null==j)){_.each(e.options,function(m){k=false;c=$(CubeViz_View_Helper.tplReplace($("#cubeviz-visualizationselector-tpl-menuItem").html(),m));l=$(c.find(".cubeviz-visualizationselector-menuSelectbox").get(0));i=CubeViz_Visualization_Controller.getObjectValueByKeyString(m.key,h);d=$("<option/>");l.data("key",m.key);if(false==_.isUndefined(i)){_.each(m.values,function(n){n.value=n.value.toString();if(i.toString()==n.value&&false==k){d=$("<option/>");d.text(n.label).val(n.value).attr("selected","selected");l.append(d);k=true}})}_.each(m.values,function(n){n.value=n.value.toString();if(false==_.isUndefined(i)&&i.toString()==n.value){return}d=$("<option/>");d.text(n.label).val(n.value);if(false===k&&false===_.isUndefined(n.isDefault)&&true===n.isDefault){d.attr("selected","selected");k=true}l.append(d)});$("#cubeviz-visualizationselector-menuItems").append(c)});$("#cubeviz-visualizationselector-closeMenu").off("click");$("#cubeviz-visualizationselector-closeMenu").on("click",$.proxy(this.onClick_closeMenu,this));$("#cubeviz-visualizationselector-updateVisz").off("click");$("#cubeviz-visualizationselector-updateVisz").on("click",$.proxy(this.onClick_updateVisz,this));$("#cubeviz-visualizationselector-menu").css("top",g.top+37).css("left",g.left-192).fadeIn("slow")}this.triggerGlobalEvent("onAfterShow_visualizationSelectorMenu")};a.prototype.showMenuDongle=function(d){var f=this.app._.backend.chartConfig[this.app._.data.numberOfMultipleDimensions].charts;var e=CubeViz_Visualization_Controller.getFromChartConfigByClass(this.app._.ui.visualization.className,f);if(false===_.isUndefined(e.options)&&0<_.size(e.options)){var c=d.position();$("#cubeviz-visualizationselector-menuDongleDiv").css("top",c.top+25).css("left",c.left+14).fadeIn("slow")}};return a})(CubeViz_View_Abstract);var View_ModelinfoAction_Footer=(function(b){__extends(a,b);function a(c,d){b.call(this,"View_Modelinfo_Footer",c,d);this.bindGlobalEvents([{name:"onStart_application",handler:this.onStart_application}])}a.prototype.initialize=function(){this.render()};a.prototype.onClick_showAnalyzeBtn=function(){window.location.href=this.app._.backend.url+"analyze/"};a.prototype.onClick_showVisualizationBtn=function(){$("#cubeviz-footer-showVisualizationButton").click()};a.prototype.onStart_application=function(){this.initialize()};a.prototype.render=function(){this.bindUserInterfaceEvents({"click #cubeviz-modelinfo-showAnalyzeBtn":this.onClick_showAnalyzeBtn,"click #cubeviz-modelinfo-showVisualizationBtn":this.onClick_showVisualizationBtn});return this};return a})(CubeViz_View_Abstract);var cubeVizApp=new CubeViz_View_Application();$(document).ready(function(){if(0<_.size(cubeVizApp._)&&"development"==cubeVizApp._.backend.context){console.log("CubeViz - Development Information:");console.log(cubeVizApp._)}cubeVizApp.triggerEvent("onStart_application")});