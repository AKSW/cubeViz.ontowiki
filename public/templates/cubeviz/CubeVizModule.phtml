<script type="text/javascript">
    /**
     * Contains loaded configuration for given hashcode
     */
    var CubeViz_Links_Module = <?php echo $this->CubeViz_Links_Module; ?>;
    
    /**
     * Contains system information related only to CubeViz
     */
    var CubeViz_Config = <?php echo $this->CubeViz_Config; ?>;
    
    /**
     * For the future
     * Will be contains all relevant information about the UI
     */
    var CubeViz_UI_ChartConfig = <?php echo $this->CubeViz_UI_ChartConfig; ?>;		
    
    
    /**
     *
     */
    $(document).ready(function(){
        
        // initialize view manager to handle all the used views
        var viewManager = new View_Manager();
        
        /**
         * Add views to view manager
         */
        // These views will added and executed on render() call. (parameter true cause that)
        viewManager.add(new View_CubeVizModule_DataStructureDefintion(), true);
        
        // These views will only added but not executed on render() call.
        viewManager.add(new View_CubeVizModule_DataSet());
        viewManager.add(new View_CubeVizModule_Component());
        
        // run
        viewManager.render();
    });
    
</script>

<!-- Selection data routine -->

<div id="wrapper"></div>

<div id="sidebar-left">
    <div id="sidebar-left-data-selection">
        
        <!-- 
        <div id="sidebar-left-loader">
            <div style="margin-top: 90px; height: 220px;">
                <img src="<?php echo $this->moduleUrl; ?>public/images/loader.gif"/>
                Loading ...
            </div>
        </div>
        -->
        
		<div id="sidebar-left-data-selection-wrapper">
            
            <br/>
            
            <!-- Select data structure-->
            <div id="cubviz-dataStructureDefinition-container">
                <div style="width: 100%; font-size: 12px; font-weight:bold; margin-bottom:2px;">
                    <?php echo $this->_translate->_('Select group of interest'); ?>
                    &nbsp;
                    <img src="<?php echo $this->cubevizImagesPath; ?>questionmark.png" 
                         class="cubeviz-icon-micro"
                         id="cubeviz-dataStructureDefinition-questionMark"
                         title="<?php echo $this->_translate->_('Click for more information'); ?>"/>
                </div>
            </div>
            
            <!-- Select data set -->
            <div id="cubviz-dataSet-container">
                <div style="width: 100%; float:left; font-size: 12px; font-weight:bold; margin-bottom:2px;">
                    <?php echo $this->_translate->_('Select part of group'); ?>
                    &nbsp;
                    <img src="<?php echo $this->cubevizImagesPath; ?>questionmark.png" 
                         title="<?php echo $this->_translate->_('Click for more information'); ?>" 
                         class="cubeviz-icon-micro"/>
                </div>
            </div>
			
            <!-- Visual seperator -->
            <div style="height: 1px; border:0; width:100%; margin-top: 6px; margin-bottom: 6px;"></div>
            
            <div id="cubviz-component-container">
				<div style="width: 100%; font-size: 12px; font-weight: bold;">
                    <?php echo $this->_translate->_('Select axis elements'); ?>
                    &nbsp;
                    <img src="<?php echo $this->cubevizImagesPath; ?>questionmark.png" 
                         title="<?php echo $this->_translate->_('Click for more information'); ?>" 
                         class="cubeviz-icon-micro"/>
                </div>
                <div id="cubviz-component-listBox">
                </div>
			</div>
            
            
            <div style="float:none; clear:both; margin-top: 25px; margin-left: 0px; margin-bottom: 5px; margin-right: 0px; padding:0px; width: 100%; min-width: 100%; max-width:100%;">				
                <span style="float:left;">
                    <input type="button" id="permaLinkButton" value="Permalink" class="minibutton submit"/>
                    <span id="permaLinkMenu">
                        <span id="permaLink">Link</span>
                    </span>
                </span>
                <span style="float:right;">
                    <input type="button" value="<?php echo $this->_translate->_('Show Visualization'); ?>" id="showUpdateVisualizationButton" class="minibutton submit"/>
                </span>
            </div>
            
		</div>
	</div>
</div>

<!-- Later on, after all loading is complete, it will contain a dialog instance -->
<div id="dimensionDialogContainer"></div>

<!-- 
    #########
    Templates
    #########
-->
<!-- Data Structure Definition -->
<script id="cubeviz-dataStructureDefinition-tpl-list" type="text/template">
    <select name="cubeviz-dataStructureDefinition-list" id="cubeviz-dataStructureDefinition-list">
    </select>
</script>

<script id="cubeviz-dataStructureDefinition-tpl-listOption" type="text/template">
    <option value="<%= url %>"<%= selected %>>
        <%= label %>
    </option>    
</script>

<!-- Data Set -->
<script id="cubeviz-dataSet-tpl-list" type="text/template">
    <select name="cubeviz-dataSet-list" id="cubeviz-dataSet-list"></select>
</script>

<script id="cubeviz-dataSet-tpl-listOption" type="text/template">
    <option value="<%= url %>"<%= selected %>>
        <%= label %>
    </option>    
</script>

<!-- Component-Dimension -->
<script id="cubeviz-component-tpl-listBoxItem" type="text/template">
    <div class="sidebar-left-data-selection-dims-box-label-value">    
        <div class="cubeviz-component-title" id="dialog-{label}-selected-items">
            <%= label %>&nbsp;(<%= selectedElementCount %> / <%= elementCount %>)
        </div>
        <div>
            Explanation text
        </div>
        <div id="open-dialog-{hashedUrl}-selector" 
               class="open-dialog-selector" 
               label="{label}" 
               hashedUrl="{hashedUrl}" 
               typeUrl="{typeUrl}" url="{url}">
            <?php echo $this->_translate->_('Select elements of interest'); ?>
        </div>        
    </div>    
</script>

<!-- Dialog -->
<script id="cubeviz-template-cubeVizModule-DimensionBox" type="text/template">
    <div class="dialog" id="dialog-{label}">
        <div class="dialog-header">
            <div class="dialog-header-label">{label}</div>
            <div style="float:right;">
                <input type="button" id="dialog-btn-close-{hashedUrl}" class="minibutton submit" hashedUrl="{hashedUrl}" label="{label}" typeUrl="{typeUrl}" url="{url}" value="<?php echo $this->_translate->_('Update and close'); ?>">
            </div>
        </div>
        <div class="dialog-components">
            <ul>
                <% _.each(list, function(name) { %> 
                    <li>
                        <input type="checkbox" name="<%= url %>" class="dialog-checkbox-<%= hashedUrl %>" value="<%= property %>" propertyLabel="<%= propertyLabel %>" property="<%= property %>"/>
                        <label class="dialog-listitem-value"><%= propertyLabel %></label>
                    </li>
                <% }); %>
            </ul>
        </div>
    </div>    
</script>
